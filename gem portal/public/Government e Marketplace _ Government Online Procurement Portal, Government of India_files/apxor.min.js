!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Apxor=t()}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}var o={enable:!0,api_root:"https://server.apxor.com/v2/api",auto_track_events:["click","submit"],cookie_expiration:730,name:"",domain:"",cookie_prefix:"_apx_",idle_time_out:3600},s={debug:!1,honorDNT:!1,idle_time_out:3600,client_id:null,session_id:null,plugins:[],version:"ALL"},a="Opera Mini",u="Opera",c="BlackBerry",d="Internet Explorer Mobile",f="Microsoft Edge",l="Facebook Mobile",h="Chrome",g="Chrome iOS",v="UC Browser",p="Firefox iOS",_="Mobile Safari",m="Safari",w="Android Mobile",y="Konqueror",S="Firefox",b="Internet Explorer",x="Mozilla",O=function(e){return e+"id"},I="_apx_ua",A="_apx_lEt",k="_apx_sId",C=function(e){return e+"in"},E=function(e){return e+"ver"},N=function(e){return e+"lbgt"},P="visible",G="BACKGROUND",T="APX_PAGE_OPENED",J="USER_EVENT",z="SYSTEM_EVENT",B="NAVIGATION_EVENT",D="APP_EVENT",K=function t(){e(this,t)};i(K,"isCookieAvailable",function(){try{var e=(new Date).getTime()+864e5;document.cookie="cookie_set=cookie_value; expires="+e;for(var t=document.cookie.split(";"),n=0;n<t.length;n++){if(-1!==t[n].indexOf("cookie_set"))return document.cookie="cookie_set=cookie_value; expires=Thu, 01 Jan 1970 00:00:01 GMT;",!0}return!1}catch(e){return!1}}),i(K,"get",function(e){if(window.document)for(var t=e+"=",n=window.document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return null});var j,F,V,R,L=function(e){return void 0===e},M=function(e){return null===e},U=function(e){return void 0!==e&&!M(e)},q=function(e){return"function"==typeof e},H=function(e){return"string"==typeof e},Z=function(e){return"boolean"==typeof e},W=function(e){return U(e)&&!M(e)&&!isNaN(e)},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(null!=t&&q(t)){var n=e.document;"loading"!==n.readyState?t():q(n.addEventListener)?n.addEventListener("DOMContentLoaded",t):q(e.attachEvent)&&e.attachEvent("onreadystatechange",function(e){"loading"!==n.readyState&&t(e)})}},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};q(t)&&(e.addEventListener("pagehide",function(e){return t(e),""}),e.addEventListener("beforeunload",function(e){return t(e),""}),e.addEventListener("onunload",function(e){return t(e),""}))},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};q(t)&&(e.removeEventListener("pagehide",t),e.removeEventListener("beforeunload",t),e.removeEventListener("onunload",t))},$=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];q(e.addEventListener)?e.addEventListener(t,n,i):q(e.attachEvent)?e.attachEvent(t,n):e["on"+t]=n},ee=function(e,t,n){q(e.removeEventListener)?e.removeEventListener(t,n):q(e.detachEvent)?e.detachEvent(t,n):e["on"+t]=n},te=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function(e){return e<10?"0"+e:e},i=e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds());return t?i+e.toTimeString().split(" ")[1].replace(/GMT([+|-])(\d{2})(\d{2})/,"$1$2:$3"):i},ne=function(){return Date.now()},ie=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!1;return setTimeout(function(){n||(n=!0,e())},t)},oe=function(){var e,t,n,o,s,O,I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},A=I.navigator,k=(A=void 0===A?{}:A).userAgent,C=void 0===k?"":k,E=A.vendor,N=void 0===E?"":E,P=a,G=u,T=c,J=d,z=f,B=l,D=h,K=g,j=v,F=p,V=_,R=m,L=w,M=y,U=S,q=b,H=x,Z=function(){switch(!0){case C.includes(" OPR/"):return C.includes("Mini")?P:G;case/(BlackBerry|PlayBook|BB10)/i.test(C):return T;case C.includes("IEMobile")||C.includes("WPDesktop"):return J;case C.includes("FBIOS"):return B;case C.includes("Chrome"):return D;case C.includes("CriOS"):return K;case C.includes("Edge"):return z;case C.includes("UCWEB")||C.includes("UCBrowser"):return j;case C.includes("FxiOS"):return F;case N.includes("Apple"):return C.includes("Mobile")?V:R;case C.includes("Android"):return L;case C.includes("Konqueror"):return M;case C.includes("Firefox"):return U;case C.includes("MSIE")||C.includes("Trident/"):return q;case C.includes("Gecko"):return H;default:return""}}(),W=function(){var e,t=(e={},i(e,J,/rv:(\d+(\.\d+)?)/),i(e,z,/Edge\/(\d+(\.\d+)?)/),i(e,D,/Chrome\/(\d+(\.\d+)?)/),i(e,K,/CriOS\/(\d+(\.\d+)?)/),i(e,j,/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/),i(e,R,/Version\/(\d+(\.\d+)?)/),i(e,V,/Version\/(\d+(\.\d+)?)/),i(e,G,/(Opera|OPR)\/(\d+(\.\d+)?)/),i(e,U,/Firefox\/(\d+(\.\d+)?)/),i(e,F,/FxiOS\/(\d+(\.\d+)?)/),i(e,M,/Konqueror:(\d+(\.\d+)?)/),i(e,T,/BlackBerry (\d+(\.\d+)?)/),i(e,L,/android\s(\d+(\.\d+)?)/),i(e,q,/(rv:|MSIE )(\d+(\.\d+)?)/),i(e,H,/rv:(\d+(\.\d+)?)/),e)[Z];if(void 0===t)return null;var n=C.match(t);return n?parseFloat(n[n.length-2]):null}(),X=function(){switch(!0){case/Windows Phone/i.test(C)||/WPDesktop/.test(C):return"Windows Phone";case/iPad/.test(C):return"iPad";case/iPod/.test(C):return"iPod Touch";case/iPhone/.test(C):return"iPhone";case/(BlackBerry|PlayBook|BB10)/i.test(C):return"BlackBerry";case/Android/.test(C):return"Android";default:return"Desktop"}}(),Q=function(){switch(!0){case/Windows/i.test(C):return/Phone/.test(C)||/WPDesktop/.test(C)?"Windows Phone":"Windows";case/(iPhone|iPad|iPod)/.test(C):return"iOS";case/Android/.test(C):return"Android";case/(BlackBerry|PlayBook|BB10)/i.test(C):return"BlackBerry";case/Mac/i.test(C):return"Mac OS X";case/Linux/.test(C):return"Linux";case/CrOS/.test(C):return"Chrome OS";default:return""}}();return r({},(e=I.screen,t=(e=void 0===e?{width:0,height:0}:e).height,n=e.width,o=I.devicePixelRatio,s=void 0===o?1:o,{dimensions:{width:n,height:t},dimensions_in_pixels:{width:(O=function(e){var t=Math.round(e)*s,n=t%10;return t+(n>0?10:0)-n})(n),height:O(t)},dpi:s.toString()}),{device:X,browser_version:W,browser:Z,os:Q})},se=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.navigator,o=(r=void 0===r?{}:r).language,s=n.browser_version,a=n.browser,u=K.isCookieAvailable();return i(e={},"apx_browser",a),i(e,"apx_browser_version",a+"_"+s),i(e,"apx_language",o),i(e,"apx_cookies_supported",u),e},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.navigator,n=(t=void 0===t?{}:t).connection,i=(n=void 0===n?{}:n).effectiveType,r=n.saveData,o=t.platform,s=t.webdriver,a=e.document.referrer,u={};return i&&(u.apx_network=i),r&&(u.apx_data_save_mode=r),o&&(u.apx_platform=o),U(s)&&s&&(u.apx_automation=s),U(a)&&a.length>0?u.apx_referrer=a:u.apx_referrer="direct",u},ue=function(e){var t=e.document.querySelector("title");return U(t)&&U(t.innerText)?t.innerText:"Unknown"},ce=function(e){return W(e)?de(e/1e3):e},de=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!W(e)||!W(t))return e;if(t%1!=0)return e;var n=Math.pow(10,t);return Math.round(e*n)/n},fe=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).location,t=(e=void 0===e?{}:e).protocol,n=e.host;return"file:"===t||"localhost"===n?"development":"production"},le=function(e){return e instanceof Object},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(le(e)){var n={};return Object.keys(r({},e)).forEach(function(i){var r=e[i],o=i;H(i)||(o=JSON.stringify(i)),Z(r)||W(r)?pe(n,o,r):H(r)?n[o]=_e(r):Array.isArray(r)?ge(n,o,r,t):le(r)&&ve(n,i,r,t-1)}),n}return{}},ge=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(i<=0)pe(e,t,JSON.stringify(n));else if(Array.isArray(n)){var r=n;if(r.length>0){var o="";Z(r[0])?o="b":H(r[0])?o="s":W(r[0])?o="n":Array.isArray(r[0])?o="a":le(r[0])&&(o="o");var s=r.length;if(""===o)return void pe(e,t,JSON.stringify(n));for(var a=1;a<s;a++)if("s"===o){if(!H(r[a]))return void pe(e,t,JSON.stringify(n))}else if("b"===o){if(!Z(r[a]))return void pe(e,t,JSON.stringify(n))}else if("n"===o){if(!W(r[a]))return void pe(e,t,JSON.stringify(n))}else if("a"===o){if(!Array.isArray(r[a]))return void pe(e,t,JSON.stringify(n))}else if("o"===o&&!le(r[a]))return void pe(e,t,JSON.stringify(n));if("o"===o)if(i-1<=0){for(var u=[],c=0;c<s;c++)u.push(JSON.stringify(r[c]));pe(e,t,u)}else for(var d=0;d<s;d++)ve(e,t,r[d],i-1);else if("a"===o)for(var f=0;f<s;f++)pe(e,t,JSON.stringify(r[f]));else for(var l=0;l<s;l++)pe(e,t,r[l])}else pe(e,t,[])}},ve=function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;o<=0?pe(t,n,JSON.stringify(i)):Object.keys(r({},i)).forEach(function(r){var s=n+"_"+r,a=i[r];U(a)&&(Array.isArray(a)?ge(t,s,a,o-1):le(a)?e(t,s,a,o-1):pe(t,s,a))})},pe=function(e,t,n){if(U(t)&&U(n))if(e.hasOwnProperty(t)){var i=e[t],r=i;Array.isArray(i)||((W(i)&&!W(n)||Z(i)&&!Z(n)||H(i)&&!H(n)||le(i)&&!le(n))&&(H(i)||(i=JSON.stringify(i)),H(n)||(n=JSON.stringify(n))),(r=[]).push(i)),r.push(n),e[t]=r}else e[t]=n},_e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return H(e)?e.length>t?e.slice(0,t)+"...":e:void 0},me=function(e){if(!U(e)&&!H(e))return!1;var t=e.replace(/(?:\r\n|\r|\n)/g,"").trim(),n=t.length;if("{"===t[0]&&"}"===t[n-1]||"["===t[0]&&"]"===t[n-1])try{return JSON.parse(t),!0}catch(e){}return!1},we=function(e,t){return function(e){var t,n,i,r,o,s,a,u,c,d=0,f="";if(!e)return e;do{t=e[d++],n=e[d++],i=e[d++],r=(u=t<<16|n<<8|i)>>18&63,o=u>>12&63,s=u>>6&63,a=63&u,f+=Se.charAt(r)+Se.charAt(o)+Se.charAt(s)+Se.charAt(a)}while(d<e.length);return((c=e.length%3)?f.slice(0,c-3):f)+"===".slice(c||3)}(t=function(e,t){return Array.from(t).map(function(t,n){return t.charCodeAt(0)^be(e,n)})}(e,t))},ye=function(e,t){return function(e,t){return Array.from(t).map(function(t,n){return String.fromCharCode(t^be(e,n))}).join("")}(e,t=function(e){var t,n,i,r,o,s,a,u,c=0,d=[];if(!e)return e;e+="";do{r=Se.indexOf(e.charAt(c++)),o=Se.indexOf(e.charAt(c++)),s=Se.indexOf(e.charAt(c++)),a=Se.indexOf(e.charAt(c++)),t=(u=r<<18|o<<12|s<<6|a)>>16&255,n=u>>8&255,i=255&u,d.push(t),64!==s&&(d.push(n),64!==a&&d.push(i))}while(c<e.length);return d}(t))},Se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function be(e,t){return e.charCodeAt(Math.floor(t%e.length))}String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.from||(Array.from=(j=Object.prototype.toString,F=function(e){return"function"==typeof e||"[object Function]"===j.call(e)},V=Math.pow(2,53)-1,R=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),V)},function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!F(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(n=arguments[2])}for(var r,o=R(t.length),s=F(this)?Object(new this(o)):new Array(o),a=0;a<o;)r=t[a],s[a]=i?void 0===n?i(r,a):i.call(n,r,a):r,a+=1;return s.length=o,s})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;var r,o,s=0|t,a=Math.max(s>=0?s:i-Math.abs(s),0);for(;a<i;){if((r=n[a])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;a++}return!1}});var xe=["log","debug","info","warn","error"],Oe=xe.reduce(function(e,t){return e[t]=t,e},{}),Ie=function(e){if(L(e)){var t=function(){return null};e=xe.reduce(function(e,n){return e[n]=t,e},{})}return e},Ae=function(){function t(){e(this,t)}return n(t,null,[{key:"enabled",set:function(e){t._enabled=e}},{key:"level",set:function(e){t._level=e}},{key:"console",set:function(e){t._console=Ie(e)}}]),t}();i(Ae,"_console",Ie()),i(Ae,"_enabled",!1),i(Ae,"_level","error"),i(Ae,"_render",function(e){return function(){var t=xe.indexOf(e)>=xe.indexOf(Ae._level);if(Ae._enabled&&t){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];Ae._console[e].apply(Ae._console,i)}}}),i(Ae,"log",Ae._render(Oe.log)),i(Ae,"info",Ae._render(Oe.info)),i(Ae,"debug",Ae._render(Oe.debug)),i(Ae,"warn",Ae._render(Oe.warn)),i(Ae,"error",Ae._render(Oe.error));var ke=function t(){var n=this;e(this,t),i(this,"Ugub",function(e,t){if(n._listeners.hasOwnProperty(e))for(var i=n._listeners[e],r=0;r<i.length;r++){(0,i[r])(t)}}),i(this,"registerForEvent",function(e,t){var i;q(t)&&((i=n._listeners.type?n._listeners[e]:[]).push(t),n._listeners[e]=i)}),i(this,"unregisterFromEvent",function(e,t){if(n._listeners[e]){for(var i=n._listeners[e],r=[],o=0;o<i.length;o++){var s=i[o];s!==t&&r.push(s)}n._listeners[e]=r}}),this._listeners={}},Ce=function(e,t,n,i){var r=e.x,o=e.y,s=e.type,a=e.target,u=a.innerText,c=a.href,d=void 0===c?"":c,f=a.nodeName;n=W(n)?de(n):0,i=W(i)?de(i):n;var l={event_type:s.toUpperCase(),event_view_text:_e(u),start_time:n,navigation_id:t,is_multi_touch:!1,began:[{x:r,y:o,time:n}],moved:[],ended:[],end_time:i};return"click"===s&&"a"===f&&(l.href=d),l},Ee=function(e,t){return{name:e===P?"FOREGROUND":G,time:W(t)?de(t):0}},Ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(H(e)&&le(t))return{name:e,additional_info:t,category:U(n)&&H(n)?n:void 0,time:W(i)?de(i):0}},Pe=function(e,t,n,i,r){return{app_name:e,app_version:r=U(r)?r:"ALL",bundle_id:t,installation_time:n,app_mode:i}},Ge=function(e,t,n,i,r,o){return{id:e,hardware_model:t,dimensions:n,os_version:i,platform:"web",dpi:r,dimensions_in_pixels:o}},Te=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{navigation_id:e,name:t,duration:W(n)?de(n):0,transition_time:W(i)?de(i):0}},Je={navigation_events:[],app_events:[],system_events:[],user_events:[],chunk_attributes:{},user_attributes:{},session_attributes:{}},ze=function t(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,t),i(this,"eSfh",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=n.window,s=o.fetch,a=o.XMLHttpRequest;Ae.debug("POST request with data"),s?s(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){try{if(e.ok)return e.json()}catch(e){}return null}).then(function(e){U(e)?i(200,e):i(500,{})}).catch(function(e){return i(500,e)}):a?n.kECk(e,t,i,!r):(Ae.error("Unknown browser..."),i(403,"Unknown")),Ae.debug("sent request to server")}),i(this,"get",function(e,t){var i=n.window,r=i.fetch,o=i.XMLHttpRequest;if(r)r(e).then(function(e){try{if(e.ok)return e.json()}catch(e){}return null}).then(function(e){U(e)?t(200,e):t(500,{})}).catch(function(e){return t(500,e)});else if(o){var s=new o;s.open("GET",n.url,!0),s.onreadystatechange=function(){4===s.readyState&&t(s.status,s.responseText)},s.send()}else Ae.error("Unknown browser..."),t(403,"Unknown");Ae.debug("sent request to server")}),i(this,"kECk",function(e,t,i,r){var o=new XMLHttpRequest;o.onerror=function(){i(500,null)},o.open("POST",e,r),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.onreadystatechange=function(){if(4===o.readyState){var r=o.responseText,s=r.match(/Failed to execute 'send' on 'XMLHttpRequest'/);if(!(M(s)||L(s)||M(s[0])||L(s[0])||"Failed to execute 'send' on 'XMLHttpRequest'"!==s[0]))return void n.kECk(e,t,i,!0);try{r=JSON.parse(r)}catch(e){Ae.error("Error in parsing XHR response ",e,r)}i(o.status,r)}};try{o.send(JSON.stringify(t))}catch(e){i(500,e)}}),this.window=r},Be=function t(n,r){var o=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(this,t),i(this,"prUv",function(e){return o.api_root+e+"?appId="+o.siteId}),i(this,"yuBK",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};return function(n,i){Ae.debug("XHR Response: [".concat(n,"]")),n<400?i&&"APXOR_STATUS_SUCCESS"===i.apxor_status?e(i.details):200===n?e(i):t(i):t&&q(t)&&t(n,i)}}),i(this,"KpUR",function(e,t,n){o.request.eSfh(o.configAPI,e,o.yuBK(t,n))}),i(this,"poIU",function(e,t,n){Ae.debug("Posting chunk"),o.request.eSfh(o.chunksAPI,e,o.yuBK(t,n),!0)}),i(this,"qGDL",function(e,t,n){o.request.get(e,o.yuBK(t,n))}),this.request=new ze(s),this.api_root=r.api_root,this.siteId=n,this.configAPI=this.prUv("/web-config"),this.chunksAPI=this.prUv("/chunks")},De=function t(n){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e(this,t),i(this,"OyJc",-1),i(this,"bqiV",0),i(this,"zAoB",function(){return r.bqiV}),i(this,"JiKU",function(){return r.OyJc}),i(this,"pGrh",function(){r.OyJc=-1,r.bqiV=0}),i(this,"PYwi",function(e){if("FOREGROUND"===e.name){if(-1!==r.OyJc){var t=Math.round(ce(Date.now()-r.OyJc));r.bqiV+=t;var n=Ue.getInstance().getFromStorage(k);if(U(n)&&Ue.getInstance().getSessionId()!==n){Ue.getInstance().bAdk();var i=Ue.getInstance().HVlR(),o=i.total_duration,s=i.duration;r.bqiV=o>s?o-s:0}}}else r.OyJc=Date.now(),Ue.getInstance().persistToStorage(N(r._cookiePrefix),r.OyJc)});var s=n.cookie_prefix;this._cookiePrefix=s,Ue.getInstance().registerForEvent(z,this._onSystemEvent),this.bqiV=o,Ue.getInstance().persistToStorage(N(this._cookiePrefix),this.OyJc)},Ke=function t(n){var r=this;e(this,t),i(this,"mhGp",function(e){var t=!0;try{window[e]?(window[e].setItem("_apx_","apx"),"apx"!==window[e].getItem("_apx_")&&(t=!1),window[e].removeItem("_apx_")):t=!1}catch(e){t=!1}return t||Ae.error("localStorage not supported..!"),t}),i(this,"ZZoK",function(e){Ae.error("".concat(r.storageType," Error: "),e)}),i(this,"get",function(e){try{return r.storage.getItem(e)}catch(e){}return null}),i(this,"UQxX",function(e){try{return JSON.parse(r.storage.getItem(e))}catch(e){}return null}),i(this,"set",function(e,t){try{r.storage.setItem(e,t)}catch(e){}}),i(this,"PsxX",function(e){try{r.storage.removeItem(e)}catch(e){}}),i(this,"clear",function(e){try{var t=e.cookie_prefix;r.storage.removeItem("_apx_config"),r.storage.removeItem(I),r.storage.removeItem(A),r.storage.removeItem(k),r.storage.removeItem("_apx_sc"),r.storage.removeItem(O(t)),r.storage.removeItem(C(t)),r.storage.removeItem(E(t)),r.storage.removeItem(N(t))}catch(e){}}),this.mhGp(n)?(this.storage=window[n],this.storageType=n):(this.storageType=n,this.storage={length:0,getItem:function(e){},setItem:function(e,t){},removeItem:function(e){},clear:function(){},get:function(e){},set:function(e,t){},remove:function(e){},getParsed:function(e){}})};var je=function t(n){var s=this;e(this,t),i(this,"jzVG",""),i(this,"IitQ",function(e,t){if(t)Array.isArray(e)||(e=[e]),s.storage.set("_apx_od",we(s.jzVG,JSON.stringify(e)));else{var n=s.rRPs();U(n)&&s.storage.set("_apx_od",we(s.jzVG,JSON.stringify([].concat(n,e))))}}),i(this,"rRPs",function(){var e=s.storage.get("_apx_od");if(U(e))if(me(e))try{e=JSON.parse(e)}catch(t){e=null}else try{e=JSON.parse(ye(s.jzVG,e))}catch(t){e=null}return e||[]}),i(this,"naGu",function(){s.storage.PsxX("_apx_od")}),i(this,"OIBP",function(){Ae.debug("Cleaning existing session data"),s.storage.PsxX("_apx_cd")}),i(this,"VRjL",function(e){s.storage.set("_apx_cd",we(s.jzVG,JSON.stringify(e)))}),i(this,"pjAG",function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3600,o=s.storage.get("_apx_cd"),a=Number(s.storage.get(A));if(W(a)&&a>0){var u=Date.now();Math.round(ce(u-Number(a)))>i&&(o=null)}var c=!1;if(U(o))if(me(o))try{o=JSON.parse(o)}catch(e){o=null}else try{o=JSON.parse(ye(s.jzVG,o))}catch(e){o=null}if(U(o)){c=!0,Ae.debug("Found session data");var d=o,f=d.chunk_meta.number,l=d.session_info.id,h=f+1;n=r({},o,{chunk_meta:r({},o.chunk_meta,{number:h,id:l+":"+h}),chunk_details:r({},o.chunk_details,Je)})}else n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return{sdk_info:{sdk_version:180,config_id:"apx",tick_interval:1,chunk_retry_window:1800,sdk_start_time:e},session_info:{id:t,launch_time:e,launch_time_string:te(new Date(e)),startup_time:0,is_background:!1,is_first_session:!1,duration:0,total_duration:0,process_name:"",is_fatal:!1,launch_type:"normal"},app_info:{app_name:"",app_version:"ALL",bundle_id:"",installation_time:ne(),app_mode:"production"},device_info:{id:"",hardware_model:"Desktop",dimensions:{height:0,width:0},os_version:"Linux x86",platform:"web",dpi:1,dimensions_in_pixels:{height:0,width:0}},chunk_meta:{id:t+":"+n,number:n,reporting_times:[]},chunk_details:r({},Je,{user_attributes:{},session_attributes:{}})}}(e,t);return{is_new_session:!c,chunk:n}}),i(this,"muPF",function(){var e=s.storage.get("_apx_config");if(U(e))if(me(e))try{e=JSON.parse(data)}catch(t){e=null}else try{e=JSON.parse(ye(s.jzVG,data))}catch(t){e=null}if(U(e)&&e.enable)return e;if(!me(e))try{var t=JSON.parse(ye(s.jzVG,e));if(U(t))return t}catch(e){}return o}),i(this,"UUUj",function(e){s.storage.set("_apx_config",we(s.jzVG,JSON.stringify(e)))}),i(this,"PRDo",function(e,t){var n=t.cookie_prefix,i=t.cookie_expiration;s.storage.set(O(n),e,i)}),i(this,"HJvf",function(e){var t=s.storage.get(O(e));if(!U(t)&&K.isCookieAvailable()){var n=K.get(O(e));if(U(n))return s.storage.set(O(e),n),n}return t}),i(this,"VqGQ",function(e,t){var n=t.cookie_prefix,i=t.cookie_expiration;s.storage.set(C(n),e,i)}),i(this,"lGJM",function(e,t){var n=e.cookie_prefix,i=s.storage.get(C(n));if(Ae.debug("Stored installation time",i),U(i))return Number(i);if(K.isCookieAvailable()){var r=K.get(C(n));if(U(r))return s.storage.set(C(n),r),Number(r)}return re(function(){return s.VqGQ(t,e)}),t}),i(this,"SBxl",function(e,t){var n=t.cookie_prefix;s.storage.set(E(n),e)}),i(this,"EbOK",function(e){var t=s.storage.get(E(e));if(!U(t)&&K.isCookieAvailable()){var n=K.get(E(e));if(U(n))return s.storage.set(E(e),n),n}return t}),i(this,"MrJf",function(e,t){s.storage.set(e,t)}),i(this,"getItem",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=s.storage.get(e);if(t&&U(n))if(me(n))try{n=JSON.parse(n)}catch(e){n=null}else try{n=JSON.parse(ye(s.jzVG,n))}catch(e){n=null}return n}),i(this,"gAfv",function(e){s.storage.clear(e)}),this.jzVG=n,this.storage=new Ke("localStorage"),Ae.debug("DataManager initialized")},Fe=["scroll","touchmove"],Ve=function t(n){var o=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e(this,t),i(this,"MRxh",!0),i(this,"WJzH",function(e){var t=e.auto_track_events;(void 0===t?[]:t).forEach(function(e){if(Ae.debug("Registering for event ",e),Fe.includes(e))o.DweN();else{var t=function(e){var t=Ce(e,window.location.pathname,Ue.getInstance().getTime());t.event_view=o.RCwf(e.target),Ue.getInstance().dispatchEvent(J,t)};o._handlers.push(o.NeHr(e,t)),$(window,e,t)}})}),i(this,"OyJX",function(){Ae.debug("Registering for System Event ","visibilitychange");var e=function(e){var t=Ue.getInstance().getTime(),n=window.document.visibilityState===P,i=Ee(window.document.visibilityState,t);if(n?o.OyJc>-1&&(i.background_time=de(ce(Date.now()-o.OyJc))):o.OyJc=Date.now(),Ue.getInstance().dispatchEvent(z,i),n){var r=Ue.getInstance().zKfm.apx_browser;!o.MRxh||-1!==r.indexOf("Mobile Safari")&&-1!==r.indexOf("Safari")||(o.MRxh=!1)}else Ue.getInstance().svvj()};$(document,"visibilitychange",e),o._handlers.push(o.NeHr("visibilitychange",e))}),i(this,"klRM",function(){o._handlers.forEach(function(e){var t=e.type,n=e.handler;Ae.debug("Unregistering from event type ",t),Fe.includes(t)?ee(window.document,t,n):ee(document,t,n)}),o._handlers=[],o._scrollEvents=[],o._scrollData={}}),i(this,"ImMs",function(){return[]}),i(this,"DweN",function(){var e,t,n,i,s,a=window.document,u=!1,c=function(a){if(!u){var c=window.location.pathname;window.requestAnimationFrame(function(){n=Ue.getInstance().getTime();var d=a.target;s=d.offsetTop?d.offsetTop:d.activeElement.offsetTop||0,e=d.children.length>0?d.children[0]:d,t=e.getBoundingClientRect().top,i=c+o.RCwf(d),Ae.debug(a.type,t,n,a),o._scrollData.hasOwnProperty(i)?o._scrollData[i].sequence.push({top:t,timestamp:n}):o._scrollData[i]={event:r({},Ce(a,c,n),{elementOffsetTop:s}),sequence:[{top:t,timestamp:n}]},u=!1}),u=!0}};Fe.forEach(function(e){o._handlers.push(o.NeHr(e,c)),$(a,e,c,!0)})}),i(this,"RCwf",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.localName,n=void 0===t?"":t,i=e.id,r=void 0===i?"":i,s=e.className,a=void 0===s?"":s,u=e.nodeName,c=void 0===u?"":u,d=n&&n.length>0?n:c;if(e.hasAttribute&&e.hasAttribute("name"))return"[name=".concat(e.getAttribute("name"),"]");if("img"===d&&e.hasAttribute&&e.hasAttribute("alt")&&e.hasAttribute("src")){var f=e.src?e.src:"Unknown src";return"img > ".concat(e.alt," - ").concat(f)}if(r.length>0)return"".concat(d,"#").concat(r," > ").concat(e.innerText);var l="".concat(d).concat(a&&a.length>0?"."+a.trim().split(" ").join("."):"");return e.parentElement?o.RCwf(e.parentElement)+" > "+l:l}),i(this,"NeHr",function(e,t){return{type:e,handler:t}}),this.OyJc=-1,this._handlers=[],this._scrollEvents=[],this._scrollData={},this.WJzH(n),this.MRxh=s,this.OyJX()},Re=function t(){var n=this;e(this,t),i(this,"qHcW",!0),i(this,"jzVG",""),i(this,"initialize",function(e,t){n.jzVG=t,e.hasOwnProperty("validate_hash")&&(n.qHcW=e.validate_hash),Ue.getInstance().registerForEvent(D,function(e){n.WgSD(e.name)})}),i(this,"fetchConfiguration",function(e,t,i,r){q(r)&&(n.qHcW?Ue.getInstance().qGDL(t,function(t){n.ZqzZ(t.hash,e,i,r)},function(){Ae.error("Failed to fetch"),r({configs:[]})}):n.dSdP(e,i,r))}),i(this,"ZqzZ",function(e,t,i,r){var o=Ue.getInstance().getFromStorage("_apx_sc",!0);U(o)||(o={});var s=t+".h";if(U(o[s])&&o[s]===e){var a=o[t];return U(a)&&(Array.isArray(a)||(a=[a]),Ae.debug("Reading from storage"),r({configs:a})),void Ue.getInstance().persistToStorage("_apx_sc",we(n.jzVG,JSON.stringify(o)))}o[s]=e,Ue.getInstance().persistToStorage("_apx_sc",we(n.jzVG,JSON.stringify(o))),n.dSdP(t,i,r)}),i(this,"dSdP",function(e,t,i){Ue.getInstance().qGDL(t,function(t){if(U(t.configs)&&Array.isArray(t.configs)&&!(t.configs.length<1)){i(t);var r=Ue.getInstance().getFromStorage("_apx_sc",!0);U(r)||(r={}),r[e]=t.configs,Ue.getInstance().persistToStorage("_apx_sc",we(n.jzVG,JSON.stringify(r)))}},function(){i({configs:[]})})}),i(this,"nYoc",function(e){n.WgSD(e)}),i(this,"WgSD",function(e){var t=Ue.getInstance().getFromStorage("_apx_sc",!0);if(U(t)||(t={}),U(t.d)||(t.d={}),JSON.stringify(t.d).length>2097152)Ae.error("Reached maximum limit. Can't store further");else{var i=0;U(t.d[e])&&(i=t.d[e]),i+=1,t.d[e]=i,Ue.getInstance().persistToStorage("_apx_sc",we(n.jzVG,JSON.stringify(t)))}}),i(this,"getEventCount",function(e){var t=Ue.getInstance().getFromStorage("_apx_sc",!0);return U(t)&&U(t.d)&&U(t.d[e])?t.d[e]:0})},Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){Ae.error("".concat(e,": Apxor SDK not initialised."))}},Me={logEvent:Le("logEvent"),logPageView:Le("logPageView"),setUserId:Le("setUserId"),setUserProperties:Le("setUserProperties"),setSessionProperties:Le("setSessionProperties"),setAppVersion:Le("setAppVersion"),getClientId:Le("getClientId"),getSessionId:Le("getSessionId"),startSession:Le("startSession"),endSession:Le("endSession"),flattenJSON:Le("flattenJSON")},Ue=function(){function t(){var n=this;return e(this,t),i(this,"yisJ",{}),i(this,"odxG",!1),i(this,"TepN",{}),i(this,"Knvu",{}),i(this,"RqkO",{}),i(this,"dojy",{}),i(this,"zKfm",{}),i(this,"LOsJ",{}),i(this,"pPZn",{}),i(this,"vZNZ",1),i(this,"LArd",null),i(this,"KSFi",!1),i(this,"sjIn",!1),i(this,"CzGB",{}),i(this,"AgiD",{}),i(this,"cxXj",{}),i(this,"nVrl",{}),i(this,"TIvd",3600),i(this,"initialize",function(e,t,i,r){n.odxG||(n.window=r,n.startTime=t,n.siteId=e,n.clientConfig=i||{},n.KIvV())}),i(this,"logEvent",function(e,t,i){if(n.odxG)if(n.KSFi){var r=Ne(e,he(t),i,n.getTime());r?n.dispatchEvent(D,r):Ae.debug("logEvent: invalid Event ",e,t)}else Ae.warn("Apxor SDK is not running");else Me.logEvent()}),i(this,"logPageView",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.getTime();if(n.odxG)if(n.KSFi)if(e&&e.length>0){var i=de(t),r=Te(e,ue(n.window),0,i);n.nVrl.nYoc(e),U(n.LArd)?(n.sqFv(),n.LArd=r):n.LArd=r,n.logEvent(T,{time:te(new Date),navigation_id:e}),Ae.debug("logPageView: page view is logged ",e)}else Ae.warn("logPageView: pathname is empty ",e);else Ae.warn("Apxor SDK is not running");else Me.logPageView()}),i(this,"setUserId",function(e){n.odxG?n.KSFi?L(e)||n.setUserProperties({custom_user_id:e}):Ae.warn("Apxor SDK is not running"):Me.setUserId()}),i(this,"setUserProperties",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.odxG?n.KSFi?Object.keys(e).length>0&&(n.zKfm=r({},n.zKfm,e)):Ae.warn("Apxor SDK is not running"):Me.setUserProperties()}),i(this,"setSessionProperties",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.odxG?n.KSFi?Object.keys(e).length>0&&(n.LOsJ=r({},n.LOsJ,e)):Ae.warn("Apxor SDK is not running"):Me.setSessionProperties()}),i(this,"setAppVersion",function(e){n.odxG?n.KSFi||Ae.warn("Apxor SDK is not running"):Me.setAppVersion()}),i(this,"flattenJSON",function(e){return he(e,2)}),i(this,"startNewSession",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();if(n.odxG){if(!n.KSFi){n.sessionId=ie(),n.startTime=e;var t=n.BMdo();n.cxXj.pGrh(),n.CzGB.VRjL(t),n.AgiD=new Ve(n.config),Ae.debug("Session Id: "+n.sessionId),n.persistToStorage(k,n.sessionId),n.KSFi=!0,Ae.debug("New session started")}}else Me.startSession()}),i(this,"endSession",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n.odxG)if(n.KSFi){var t=r({},n.pPZn,{user_attributes:r({},n.zKfm),session_attributes:r({},n.LOsJ)});e||n.sqFv();var i=n.ojRn(t);n.snQY(i,!0),n.CzGB.OIBP(),n.cxXj.pGrh(),U(n.AgiD)&&n.sjIn&&n.AgiD.klRM(),Y(document),n.KSFi=!1,Ae.debug("Current session ended")}else Ae.warn("Apxor SDK is not running. Please make sure to call 'startSession'");else Me.endSession()}),i(this,"getSessionId",function(){return n.sessionId}),i(this,"gNaK",function(){return n.odxG?n.KSFi?n._deviceId:(Ae.warn("Apxor SDK is not running"),null):(Me.getClientId(),null)}),i(this,"registerForEvent",function(e,t){n.yisJ.registerForEvent(e,t)}),i(this,"unregisterFromEvent",function(e,t){n.yisJ.unregisterFromEvent(e,t)}),i(this,"getTime",function(){return ce(Date.now()-n.startTime)}),i(this,"dispatchEvent",function(e,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Ae.debug("Dispatching Event: ",e,o);var s=n.CzGB.HJvf("_apx_");U(s)&&s===n.Knvu.id||(n.CzGB.PRDo(n.Knvu.id,n.config),n.CzGB.SBxl(n.TepN.app_version,n.config),n.CzGB.VqGQ(n.startTime,n.config),n.persistToStorage(I,we(n.siteId,JSON.stringify(n.zKfm))));var a=n.pPZn,u=a.app_events,c=a.system_events,d=a.navigation_events,f=a.user_events;switch(e){case D:n.pPZn=r({},n.pPZn,{app_events:[].concat(u,i)});break;case z:n.WGHa();break;case B:n.pPZn=r({},n.pPZn,{navigation_events:[].concat(d,i)});break;case J:n.WGHa()}if(n.yisJ.Ugub(e,i),e===D){var l=Date.now(),h=n.getFromStorage(A);if(h=Number(h),n.persistToStorage(A,Date.now()),W(h)&&h>0&&Math.round(ce(l-h))>n.TIvd)return t.getInstance().endSession(!0),void t.getInstance().startNewSession(Date.now())}var g=r({},n.pPZn,{user_attributes:r({},n.zKfm),session_attributes:r({},n.LOsJ)}),v=n.ojRn(g,e);(u.length+c.length+d.length+f.length+1>=n._maxEventsSentCount||e===z&&i.name===G||e===D)&&(n.snQY(v,o),n.pPZn=r({},Je,{user_attributes:r({},n.zKfm),session_attributes:r({},n.LOsJ)}),n.vZNZ+=1)}),i(this,"persistToStorage",function(e,t){var i=t;arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&me(i)&&(i=we(n.siteId,JSON.stringify(i))),n.CzGB.MrJf(e,i)}),i(this,"getFromStorage",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.CzGB.getItem(e,t)}),i(this,"HVlR",function(){return n.dojy}),i(this,"bAdk",function(){n.BMdo()}),i(this,"getUserAttributes",function(){return n.zKfm}),i(this,"getSessionAttributes",function(){return n.LOsJ}),i(this,"qGDL",function(e,t,i){n._api.qGDL(e,t,i)}),i(this,"fetchConfiguration",function(e,t,i,r){n.nVrl.fetchConfiguration(e,t,i,r)}),i(this,"KIvV",function(){try{Ae.info("Controller initializing with client config",n.clientConfig),n.newSession=!0,n.sessionId=ie(),n.yisJ=new ke,n.CzGB=new je(n.siteId),n.nVrl=new Re,n.oViW(n.CzGB.muPF()),n.nVrl.initialize(n.config,n.siteId);var e=n.getFromStorage(I,!1);if(U(e))if(Ae.debug("Retrieved Stored User attributes"),me(e))n.zKfm=r({},n.zKfm,JSON.parse(e));else{var t={};try{t=JSON.parse(ye(n.siteId,e))}catch(e){}n.zKfm=r({},n.zKfm,t)}var i=n.config.idle_time_out,o=n.getFromStorage(N(n.config.cookie_prefix)),s=ce(n.startTime-Number(o));U(o)&&o>-1&&s>i?(n.CzGB.OIBP(),s=0):(!U(o)||o<1)&&(s=0);var a=n.BMdo();n.newSession&&(s=0);var u=n.config.max_chunk_event_count,c=void 0===u?20:u;n._maxEventsSentCount=c;var d=n.dojy,f=d.total_duration,l=d.duration,h=s+(f>l?f-l:0);n.cxXj=new De(n.config,h),n._api=new Be(n.siteId,n.config,n.window),n.vvZD(n.config),n.CzGB.VRjL(a),Ae.debug("Session Id: "+n.sessionId),n.persistToStorage(k,n.sessionId),n.KSFi=!0,n.odxG=!0,setTimeout(function(){var e=n.config.plugins;if(U(e)&&U(e.length))for(var t=0;t<e.length;t++){var i=e[t];try{window[i].init(),Ae.info("Initialized plugin: ",i)}catch(e){Ae.error("Failed to initialize plugin: "+i)}}},1e3)}catch(e){Ae.error("Failed to initialize SDK: ",e),n.odxG=!1}}),i(this,"oViW",function(e){n.config=r({},e,n.clientConfig);var t=n.config.max_chunk_event_count,i=void 0===t?20:t;n._maxEventsSentCount=i,Ae.debug("Config updated")}),i(this,"BMdo",function(){var e=n.CzGB.pjAG(n.startTime,n.sessionId,n.config.idle_time_out),t=e.chunk;n.newSession=e.is_new_session;var i=t.session_info,o=t.device_info,s=t.app_info,a=t.sdk_info,u=t.chunk_details,c=t.chunk_meta;n.dojy=i,n.RqkO=a,n.TepN=s,n.Knvu=o,n.pPZn=u;var d=c.number;n.vZNZ=d;var f=u.session_attributes,l=u.user_attributes;n.zKfm=r({},n.zKfm,l),n.LOsJ=r({},n.LOsJ,f),n.lhsv(),n.BSWF();var h=n.config.name;n.TepN.app_name=U(h)?h:"";var g,v=n.config.domain;if(n.TepN.bundle_id=U(v)?v:"",console.log("APP VERSION: "+n.clientConfig.version),U(n.clientConfig.version))g=""+n.clientConfig.version,n.CzGB.SBxl(g,n.config);else{var p=n.CzGB.EbOK(n.config.cookie_prefix);g=U(p)?p:"ALL"}if(n.TepN.app_version=g,!e.is_new_session){var _=t.session_info.id,m=t.session_info.launch_time;n.sessionId=_,n.startTime=m}var w={id:n.sessionId+":"+n.vZNZ,number:n.vZNZ,reporting_times:[Date.now()]};return{sdk_info:n.RqkO,session_info:n.dojy,app_info:n.TepN,device_info:n.Knvu,chunk_meta:w,chunk_details:n.pPZn}}),i(this,"vvZD",function(e){var t=n.RqkO.sdk_version,i={sdk_version:JSON.stringify(t),app_info:n.TepN,device_info:n.Knvu,user_attributes:n.zKfm};n._api.KpUR(i,function(e){Ae.debug("Fetch new config"),n.CzGB.UUUj(e),n.oViW(e),n.BSWF(),n.RCEn(e);var t=n.config.idle_time_out,i=void 0===t?3600:t;n.TIvd=W(i)?i:3600},function(){Ae.error("Failed to fetch config"),n.RCEn(e)})}),i(this,"RCEn",function(e){if(e.enable||U(e.details)&&e.details.enable){Ae.debug("Monitoring started...");var t=Ee(n.window.document.visibilityState,n.getTime());n.dispatchEvent(z,t),n.logPageView(n.window.location.pathname,n.getTime()),n.lTWg(),n.nJEm()}}),i(this,"nJEm",function(){re(function(){Ae.debug("Checking for previous data:");var e=n.CzGB.rRPs();if(U(e)&&Array.isArray(e)&&e.length>0){Ae.debug("Found old data");var t=e.length,i=[],r=function(){0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)&&(i.length>0?(Ae.debug("Failed to report previous data:"),n.CzGB.IitQ(i,!0)):(Ae.debug("Removing transient data"),n.CzGB.naGu()))};e.forEach(function(e){U(e.app_info.app_name)||(e.app_info.app_name="",e.device_info.id=n.CzGB.HJvf("_apx_")),U(e.app_info.bundle_id)||(e.app_info.bundle_id="",e.device_info.id=n.CzGB.HJvf("_apx_")),n._api.poIU(e,function(){r(--t)},function(o){413===o?n.xOri(e):417!==o&&i.push(e),r(--t)})})}},1e3)}),i(this,"brei",function(){var e=!1;Q(window,function(t){if(!e&&n.KSFi){if(e=!0,Ae.debug("Executing before unload"),window.document.visibilityState===P){n.sqFv();var i=Ee("hidden",n.getTime());n.dispatchEvent(z,i,!0)}n.AgiD.klRM()}})}),i(this,"snQY",function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(U(e)&&U(e.chunk_details)){var i=e.chunk_details,r=i.app_events,o=i.system_events,s=i.navigation_events,a=i.user_events;r.length<1&&o.length<1&&s.length<1&&a.length<1||(n.persistToStorage(I,we(n.siteId,JSON.stringify(n.zKfm))),n.CzGB.VRjL(e),U(e.app_info.app_name)||(e.app_info.app_name="",e.device_info.id=n.CzGB.HJvf("_apx_")),U(e.app_info.bundle_id)||(e.app_info.bundle_id="",e.device_info.id=n.CzGB.HJvf("_apx_")),t?n.CzGB.IitQ(e):n._api.poIU(e,void 0,function(t){413===t?n.xOri(e):417!==t&&n.CzGB.IitQ(e)}))}}),i(this,"ZAPa",function(){var e=n.config.cookie_prefix,t=n.clientConfig.client_id,i=n.CzGB.HJvf(e);if(!U(i)){U(t)&&""!==t?i=t:(i=ie(),Ae.debug("New device Found")),n.CzGB.gAfv(n.config),n.CzGB.PRDo(i,n.config),n.CzGB.VqGQ(n.startTime,n.config);n.dojy=r({},n.dojy,{is_first_session:!0})}return Ae.debug("Device Id: ",i),i}),i(this,"lhsv",function(){n._deviceId=n.ZAPa();var e=oe(n.window),t=e.device,i=e.os,o=e.browser_version,s=e.browser,a=e.dimensions,u=e.dpi,c=e.dimensions_in_pixels,d=Ge(n._deviceId,t,a,i,u,c);n.Knvu=r({},d),n.fRTU(r({},d,{browser:s,browser_version:o}))}),i(this,"fRTU",function(e){var t=se(n.window,e);n.zKfm=r({},n.zKfm,t);var i=ae(n.window);n.LOsJ=r({},n.LOsJ,i)}),i(this,"lTWg",function(){X(n.window,function(){n.sjIn||(n.brei(),n.AgiD=new Ve(n.config,!1),n.sjIn=!0)})}),i(this,"BSWF",function(){var e=n.config,t=e.name,i=e.domain,o=e.cookie_prefix,s=n.CzGB.lGJM(n.config,n.startTime),a=fe(n.window),u=n.CzGB.EbOK(o),c=Pe(t,i,s,a,u);n.TepN=r({},c)}),i(this,"sqFv",function(){U(n.LArd)&&(n.LArd.duration=de(n.getTime()-n.LArd.transition_time),n.dispatchEvent(B,r({},n.LArd)))}),i(this,"svvj",function(){n.sqFv(),n.LArd=null}),i(this,"xOri",function(e){var t=e.chunk_details,i=t.user_events,r=t.app_events;i.length>0&&n.TeaC(i,i,t,e),r.length>0&&n.TeaC(r,r,t,e)}),i(this,"TeaC",function(e,t,i,o){var s=t.length,a=t.splice(s/2,s),u=r({},i,t,{type:[]}),c=r({},o,u);U(c.app_info.app_name)||(c.app_info.app_name="",c.device_info.id=n.CzGB.HJvf("_apx_")),U(c.app_info.bundle_id)||(c.app_info.bundle_id="",c.device_info.id=n.CzGB.HJvf("_apx_")),n._api.poIU(c,null,function(e){413!==e&&417!==e&&n.CzGB.IitQ(c,!1)}),u=r({},i,a,{type:[]});var d=r({},o,u);U(d.app_info.app_name)||(d.app_info.app_name="",d.device_info.id=n.CzGB.HJvf("_apx_")),U(d.app_info.bundle_id)||(d.app_info.bundle_id="",d.device_info.id=n.CzGB.HJvf("_apx_")),n._api.poIU(d,null,function(e){413!==e&&417!==e&&n.CzGB.IitQ(d,!1)})}),i(this,"ojRn",function(e){n.WGHa();var t={id:n.sessionId+":"+n.vZNZ,number:n.vZNZ,reporting_times:[Date.now()]};return e=r({},e,{user_attributes:n.zKfm,session_attributes:n.LOsJ}),{sdk_info:n.RqkO,session_info:n.dojy,app_info:n.TepN,device_info:n.Knvu,chunk_meta:t,chunk_details:e}}),i(this,"WGHa",function(){var e=n.getTime(),t=e;e-=n.cxXj.zAoB(),n.dojy=r({},n.dojy,{duration:de(e),total_duration:de(t)})}),i(this,"getEventCount",function(e){return n.nVrl.getEventCount(e)}),t.instance||(t.instance=this),t.instance}return n(t,null,[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}]),t}();i(Ue,"instance",void 0);var qe=function t(n){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne();e(this,t),i(this,"odxG",!1),i(this,"cDfW",function(){Array.isArray(r._q)&&r._q.forEach(function(e){var t=e.m,n=e.args;r.hasOwnProperty(t)&&q(r[t])&&r[t].apply(r,Array.from(n))})}),i(this,"init",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{if(!r.odxG){if(!U(e)||!U(e.trim)||""===e.trim())return void Ae.error("ApxorSDK couldn't be initialized: Invalid Site Id");if(U(t)&&!(t instanceof Object))return void Ae.error("ApxorSDK couldn't be initialized: Invalid config");var o=t.honorDNT,a=void 0!==o&&o,u=t.debug,c=void 0!==u&&u;if(r.PVXD(c),a&&!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.navigator){var t=e.navigator.doNotTrack;return!("1"===t||"yes"===t)}return!0}(r.window))return r._controller=Me,null!=i&&q(i)&&i(),void Ae.error("Tracking is disabled, ApxorSDK couldn't be initialized");r._controller=Ue.getInstance(),r._controller.initialize(e,r._startTime,t,r.window),r.odxG=!0,null!=n&&q(n)&&(Ae.debug("CLIENT_ID: "+r.getClientId()),n({client_id:r.getClientId(),session_id:r.getSessionId()})),r.window.console.info("ApxorSDK initialized for "+e+" with SDK version: 180")}}catch(e){Ae.error("Failed to initialize Apxor SDK",e),i&&q(i)&&i(e)}}),i(this,"PVXD",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ae.enabled=e,Ae.level="error",Ae.console=r.window.console}),i(this,"logEvent",function(e,t){return r._controller.logEvent(e,t)}),i(this,"logPageView",function(e){return r._controller.logPageView(e)}),i(this,"setUserId",function(e){return r._controller.setUserId(e)}),i(this,"setUserProperties",function(e){return r._controller.setUserProperties(e)}),i(this,"setSessionProperties",function(e){return r._controller.setSessionProperties(e)}),i(this,"setAppVersion",function(e){return r._controller.setAppVersion(e)}),i(this,"flattenJSON",function(e){return r._controller.flattenJSON(e)}),i(this,"getSessionId",function(){return r._controller.getSessionId()}),i(this,"getClientId",function(){return r._controller.gNaK()}),i(this,"startNewSession",function(){r._controller.startNewSession(Date.now())}),i(this,"endSession",function(){r._controller.endSession()}),i(this,"getController",function(){return r._controller}),this.window=n,this._startTime=o,this.cDfW()};window.Apxor=window.Apxor||{_q:[],_st:new Date},qe.prototype._q=window.Apxor._q;var He=new qe(window,+window.Apxor._st);window.Apxor=He,window.ApxorLogger=Ae;try{void 0===exports&&null===exports||(exports.default=He,module.exports=exports.default)}catch(e){}return He});
