window.MozWebSocket&&(window.WebSocket=window.MozWebSocket);var jws={VERSION:"1.0b1 (nightly build 10906)",NS_BASE:"ozonetel.cloudagent",NS_SYSTEM:"ozonetel.cloudagent",MSG_WS_NOT_SUPPORTED:"Unfortunately your browser does neither natively support WebSockets\nnor you have the Adobe Flash-PlugIn 10+ installed.\nPlease download the last recent Adobe Flash Player at http://get.adobe.com/flashplayer.",CUR_TOKEN_ID:0,JWS_SERVER_SCHEMA:"ws",JWS_SERVER_SSL_SCHEMA:"wss",JWS_SERVER_HOST:self.location.hostname?self.location.hostname:"127.0.0.1",JWS_SERVER_PORT:8787,JWS_SERVER_SSL_PORT:9797,JWS_SERVER_CONTEXT:"/jWebSocket",JWS_SERVER_SERVLET:"/jWebSocket",JWS_SERVER_URL:"ws://"+(self.location.hostname?self.location.hostname:"127.0.0.1")+":8787/jWebSocket/jWebSocket",CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,RECONNECTING:1e3,OPEN_TIMED_OUT:1001,RO_OFF:{autoReconnect:!1,reconnectDelay:-1,reconnectTimeout:-1,queueItemLimit:-1,queueSizeLimit:-1},RO_ON:{autoReconnect:!0,reconnectDelay:500,reconnectTimeout:3e4,queueItemLimit:1e3,queueSizeLimit:10485760},WS_SUBPROT_JSON:"org.jwebsocket.json",WS_SUBPROT_XML:"org.jwebsocket.xml",WS_SUBPROT_CSV:"org.jwebsocket.csv",WS_SUBPROT_CUSTOM:"org.jwebsocket.text",WS_SUBPROT_TEXT:"org.jwebsocket.text",WS_SUBPROT_BINARY:"org.jwebsocket.binary",SCOPE_PRIVATE:"private",SCOPE_PUBLIC:"public",DEF_RESP_TIMEOUT:5e3,BT_UNKNOWN:0,BT_FIREFOX:1,BT_NETSCAPE:2,BT_OPERA:3,BT_IEXPLORER:4,BT_SAFARI:5,BT_CHROME:6,BROWSER_NAMES:["Unknown","Firefox","Netscape","Opera","Internet Explorer","Safari","Chrome"],GUEST_USER_LOGINNAME:"guest",GUEST_USER_PASSWORD:"guest",DEMO_ROOT_LOGINNAME:"root",DEMO_ROOT_PASSWORD:"root",$:function(e){return document.getElementById(e)},getServerURL:function(e,t,n,o,s){var r=e+"://"+t+(n?":"+n:"");return o&&0<o.length&&(r+=o,s&&0<s.length&&(r+=s)),r},getDefaultServerURL:function(){return this.getServerURL(jws.JWS_SERVER_SCHEMA,jws.JWS_SERVER_HOST,jws.JWS_SERVER_PORT,jws.JWS_SERVER_CONTEXT,jws.JWS_SERVER_SERVLET)},getDefaultSSLServerURL:function(){return this.getServerURL(jws.JWS_SERVER_SSL_SCHEMA,jws.JWS_SERVER_HOST,jws.JWS_SERVER_SSL_PORT,jws.JWS_SERVER_CONTEXT,jws.JWS_SERVER_SERVLET)},browserSupportsWebSockets:function(){return null!==window.WebSocket&&void 0!==window.WebSocket},browserSupportsNativeWebSockets:null!==window.WebSocket&&void 0!==window.WebSocket,browserSupportsJSON:function(){return null!==window.JSON&&void 0!==window.JSON},browserSupportsNativeJSON:null!==window.JSON&&void 0!==window.JSON,browserSupportsWebWorkers:null!==window.Worker&&void 0!==window.Worker,runAsThread:function(e){if(!this.browserSupportsWebWorkers)return{code:-1,msg:"Browser does not (yet) support WebWorkers."};e||(e={});var t=null,n=null,o=jws.SCRIPT_PATH+"jwsWorker.js",s=null,r=[];e.OnMessage&&"function"==typeof e.OnMessage&&(t=e.OnMessage),e.OnError&&"function"==typeof e.OnError&&(n=e.OnError),e.file&&"String"==typeof e.file&&(o=e.file),e.method&&"function"==typeof e.method&&(s=e.method),e.args&&(r=e.args);var i=this;return jws.worker||(jws.worker=new Worker(o),jws.worker.onmessage=function(e){null!=t&&t.call(i,{data:e.data})},jws.worker.onerror=function(e){null!=n&&n.call(i,{message:e.message})}),jws.worker.postMessage({method:s.toString(),args:r}),{code:0,msg:"ok",worker:jws.worker}},SCRIPT_PATH:function(){for(var e=document.getElementsByTagName("script"),t=0,n=e.length;t<n;t++){var o=e[t],s=o.src;if(s||(s=o.getAttribute("src")),s){var r=s.lastIndexOf("jWebSocket");if(0<r)return s.substr(0,r)}}return null}(),isIE:0<=navigator.userAgent.indexOf("MSIE"),getBrowserName:function(){return this.fBrowserName},getBrowserVersion:function(){return this.fBrowserVerNo},getBrowserVersionString:function(){return this.fBrowserVerStr},isFirefox:function(){return this.fIsFirefox},isOpera:function(){return this.fIsOpera},isChrome:function(){return this.fIsChrome},isIExplorer:function(){return this.fIsIExplorer},isIE_LE6:function(){return this.isIExplorer()&&this.getBrowserVersion()<7},isIE_LE7:function(){return this.isIExplorer()&&this.getBrowserVersion()<8},isIE_GE8:function(){return this.isIExplorer()&&8<=this.getBrowserVersion()},isSafari:function(){return this.fIsSafari},isNetscape:function(){return this.fIsNetscape},isPocketIE:function(){return this.fIsPocketIE},console:{isActive:!1,level:2,ALL:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5,log:function(e){window.console&&jws.console.isActive&&console.log(e)},debug:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.DEBUG&&console.debug(e)},info:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.INFO&&console.info(e)},warn:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.WARN&&console.warn(e)},error:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.ERROR&&console.error(e)},fatal:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.FATAL&&console.fatal(e)}}};!function(){jws.fBrowserName="unknown",jws.fBrowserType=jws.BT_UNKNOWN,jws.fBrowserVerNo=void 0,jws.fIsIExplorer=!1,jws.fIsFirefox=!1,jws.fIsNetscape=!1,jws.fIsOpera=!1,jws.fIsSafari=!1,jws.fIsChrome=!1;var e,t,n,o,s,r=navigator.userAgent;if(jws.fIsChrome=0<=r.indexOf("Chrome"),jws.fIsChrome?jws.fBrowserType=jws.BT_CHROME:(jws.fIsSafari=0<=r.indexOf("Safari"),jws.fIsSafari?jws.fBrowserType=jws.BT_SAFARI:(jws.fIsNetscape=0<=r.indexOf("Netscape"),jws.fIsNetscape?jws.fBrowserType=jws.BT_NETSCAPE:(jws.fIsFirefox="Netscape"==navigator.appName,jws.fIsFirefox?jws.fBrowserType=jws.BT_FIREFOX:(jws.fIsOpera="Opera"==navigator.appName,jws.fIsOpera?jws.fBrowserType=jws.BT_OPERA:(jws.fIsIExplorer="Microsoft Internet Explorer"==navigator.appName,jws.fIsIExplorer?jws.fBrowserType=jws.BT_IEXPLORER:(jws.fIsPocketIE="Microsoft Pocket Internet Explorer"==navigator.appName,jws.fIsPocketIE&&(jws.fBrowserType=jws.BT_IEXPLORER))))))),jws.fIsIExplorer)jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_IEXPLORER],(s=r.match(/MSIE.*/i))&&(e=(n=s[0].substr(5)).indexOf(";"),jws.fBrowserVerStr=0<e?n.substr(0,e):n,jws.fBrowserVerNo=parseFloat(jws.fBrowserVerStr));else if(jws.fIsFirefox){if(jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_FIREFOX],s=r.match(/Firefox\/.*/i)){for(e=(n=s[0].substr(8)).indexOf(" "),jws.fBrowserVerStr=0<e?n.substring(0,e):n,t=o=0;t<n.length&&("."==n.charAt(t)&&o++,!(2<=o));)t++;n=n.substring(0,t),jws.fBrowserVerNo=parseFloat(n)}}else if(jws.fIsNetscape){if(jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_NETSCAPE],s=r.match(/Netscape\/.*/i)){for(e=(n=s[0].substr(9)).indexOf(" "),jws.fBrowserVerStr=0<e?n.substring(0,e):n,t=o=0;t<n.length&&("."==n.charAt(t)&&o++,!(2<=o));)t++;n=n.substring(0,t),jws.fBrowserVerNo=parseFloat(n)}}else if(jws.fIsOpera)jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_OPERA],(s=r.match(/Opera\/.*/i))&&(e=(n=s[0].substr(6)).indexOf(" "),jws.fBrowserVerStr=0<e?n.substr(0,e):n,jws.fBrowserVerNo=parseFloat(n),n=(s=r.match(/Version\/.*/i))[0].substr(8),s&&(e=n.indexOf(" "),jws.fBrowserVerStr=(0<e?n.substr(0,e):n)+"/"+jws.fBrowserVerStr,jws.fBrowserVerNo=parseFloat(n)));else if(jws.fIsChrome)jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_CHROME],(s=r.match(/Chrome\/.*/i))&&(e=(n=s[0].substr(7)).indexOf(" "),jws.fBrowserVerStr=0<e?n.substr(0,e):n,jws.fBrowserVerNo=parseFloat(n));else if(jws.fIsSafari&&(jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_SAFARI],s=r.match(/Version\/.*/i))){for(e=(n=s[0].substr(8)).indexOf(" "),jws.fBrowserVerStr=0<e?n.substr(0,e):n,t=o=0;t<n.length&&("."==n.charAt(t)&&o++,!(2<=o));)t++;n=n.substring(0,t),jws.fBrowserVerNo=parseFloat(n),(s=r.match(/Safari\/.*/i))&&(e=(n="."+s[0].substr(7)).indexOf(" "),jws.fBrowserVerStr+=0<e?n.substr(0,e):n)}}(),jws.events={addEventListener:jws.isIE?function(e,t,n){e.attachEvent("on"+t,n)}:function(e,t,n){e.addEventListener(t,n,!1)},getTarget:jws.isIE?function(e){return e.srcElement}:function(e){return e.target},preventDefault:jws.isIE?function(e){(e=window.event)&&(e.returnValue=!1)}:function(e){return e.preventDefault()}};var hexcase=0,b64pad="";function hex_md5(e){return rstr2hex(rstr_md5(str2rstr_utf8(e)))}function b64_md5(e){return rstr2b64(rstr_md5(str2rstr_utf8(e)))}function any_md5(e,t){return rstr2any(rstr_md5(str2rstr_utf8(e)),t)}function hex_hmac_md5(e,t){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)))}function b64_hmac_md5(e,t){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)))}function any_hmac_md5(e,t,n){return rstr2any(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)),n)}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(e){return binl2rstr(binl_md5(rstr2binl(e),8*e.length))}function rstr_hmac_md5(e,t){var n=rstr2binl(e);16<n.length&&(n=binl_md5(n,8*e.length));for(var o=Array(16),s=Array(16),r=0;r<16;r++)o[r]=909522486^n[r],s[r]=1549556828^n[r];var i=binl_md5(o.concat(rstr2binl(t)),512+8*t.length);return binl2rstr(binl_md5(s.concat(i),640))}function rstr2hex(e){for(var t,n=hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",s=0;s<e.length;s++)t=e.charCodeAt(s),o+=n.charAt(t>>>4&15)+n.charAt(15&t);return o}function rstr2b64(e){for(var t="",n=e.length,o=0;o<n;o+=3)for(var s=e.charCodeAt(o)<<16|(o+1<n?e.charCodeAt(o+1)<<8:0)|(o+2<n?e.charCodeAt(o+2):0),r=0;r<4;r++)8*o+6*r>8*e.length?t+=b64pad:t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>>6*(3-r)&63);return t}function rstr2any(e,t){var n,o,s,r,i,a=t.length,c=Array(Math.ceil(e.length/2));for(n=0;n<c.length;n++)c[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var l=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),u=Array(l);for(o=0;o<l;o++){for(i=Array(),n=r=0;n<c.length;n++)r=(r<<16)+c[n],r-=(s=Math.floor(r/a))*a,(0<i.length||0<s)&&(i[i.length]=s);u[o]=r,c=i}var f="";for(n=u.length-1;0<=n;n--)f+=t.charAt(u[n]);return f}function str2rstr_utf8(e){for(var t,n,o="",s=-1;++s<e.length;)t=e.charCodeAt(s),n=s+1<e.length?e.charCodeAt(s+1):0,55296<=t&&t<=56319&&56320<=n&&n<=57343&&(t=65536+((1023&t)<<10)+(1023&n),s++),t<=127?o+=String.fromCharCode(t):t<=2047?o+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?o+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(o+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return o}function str2rstr_utf16le(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t}function str2rstr_utf16be(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t}function rstr2binl(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}function binl2rstr(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function binl_md5(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,o=-271733879,s=-1732584194,r=271733878,i=0;i<e.length;i+=16){var a=n,c=o,l=s,u=r;o=md5_ii(o=md5_ii(o=md5_ii(o=md5_ii(o=md5_hh(o=md5_hh(o=md5_hh(o=md5_hh(o=md5_gg(o=md5_gg(o=md5_gg(o=md5_gg(o=md5_ff(o=md5_ff(o=md5_ff(o=md5_ff(o,s=md5_ff(s,r=md5_ff(r,n=md5_ff(n,o,s,r,e[i+0],7,-680876936),o,s,e[i+1],12,-389564586),n,o,e[i+2],17,606105819),r,n,e[i+3],22,-1044525330),s=md5_ff(s,r=md5_ff(r,n=md5_ff(n,o,s,r,e[i+4],7,-176418897),o,s,e[i+5],12,1200080426),n,o,e[i+6],17,-1473231341),r,n,e[i+7],22,-45705983),s=md5_ff(s,r=md5_ff(r,n=md5_ff(n,o,s,r,e[i+8],7,1770035416),o,s,e[i+9],12,-1958414417),n,o,e[i+10],17,-42063),r,n,e[i+11],22,-1990404162),s=md5_ff(s,r=md5_ff(r,n=md5_ff(n,o,s,r,e[i+12],7,1804603682),o,s,e[i+13],12,-40341101),n,o,e[i+14],17,-1502002290),r,n,e[i+15],22,1236535329),s=md5_gg(s,r=md5_gg(r,n=md5_gg(n,o,s,r,e[i+1],5,-165796510),o,s,e[i+6],9,-1069501632),n,o,e[i+11],14,643717713),r,n,e[i+0],20,-373897302),s=md5_gg(s,r=md5_gg(r,n=md5_gg(n,o,s,r,e[i+5],5,-701558691),o,s,e[i+10],9,38016083),n,o,e[i+15],14,-660478335),r,n,e[i+4],20,-405537848),s=md5_gg(s,r=md5_gg(r,n=md5_gg(n,o,s,r,e[i+9],5,568446438),o,s,e[i+14],9,-1019803690),n,o,e[i+3],14,-187363961),r,n,e[i+8],20,1163531501),s=md5_gg(s,r=md5_gg(r,n=md5_gg(n,o,s,r,e[i+13],5,-1444681467),o,s,e[i+2],9,-51403784),n,o,e[i+7],14,1735328473),r,n,e[i+12],20,-1926607734),s=md5_hh(s,r=md5_hh(r,n=md5_hh(n,o,s,r,e[i+5],4,-378558),o,s,e[i+8],11,-2022574463),n,o,e[i+11],16,1839030562),r,n,e[i+14],23,-35309556),s=md5_hh(s,r=md5_hh(r,n=md5_hh(n,o,s,r,e[i+1],4,-1530992060),o,s,e[i+4],11,1272893353),n,o,e[i+7],16,-155497632),r,n,e[i+10],23,-1094730640),s=md5_hh(s,r=md5_hh(r,n=md5_hh(n,o,s,r,e[i+13],4,681279174),o,s,e[i+0],11,-358537222),n,o,e[i+3],16,-722521979),r,n,e[i+6],23,76029189),s=md5_hh(s,r=md5_hh(r,n=md5_hh(n,o,s,r,e[i+9],4,-640364487),o,s,e[i+12],11,-421815835),n,o,e[i+15],16,530742520),r,n,e[i+2],23,-995338651),s=md5_ii(s,r=md5_ii(r,n=md5_ii(n,o,s,r,e[i+0],6,-198630844),o,s,e[i+7],10,1126891415),n,o,e[i+14],15,-1416354905),r,n,e[i+5],21,-57434055),s=md5_ii(s,r=md5_ii(r,n=md5_ii(n,o,s,r,e[i+12],6,1700485571),o,s,e[i+3],10,-1894986606),n,o,e[i+10],15,-1051523),r,n,e[i+1],21,-2054922799),s=md5_ii(s,r=md5_ii(r,n=md5_ii(n,o,s,r,e[i+8],6,1873313359),o,s,e[i+15],10,-30611744),n,o,e[i+6],15,-1560198380),r,n,e[i+13],21,1309151649),s=md5_ii(s,r=md5_ii(r,n=md5_ii(n,o,s,r,e[i+4],6,-145523070),o,s,e[i+11],10,-1120210379),n,o,e[i+2],15,718787259),r,n,e[i+9],21,-343485551),n=safe_add(n,a),o=safe_add(o,c),s=safe_add(s,l),r=safe_add(r,u)}return Array(n,o,s,r)}function md5_cmn(e,t,n,o,s,r){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(o,r)),s),n)}function md5_ff(e,t,n,o,s,r,i){return md5_cmn(t&n|~t&o,e,t,s,r,i)}function md5_gg(e,t,n,o,s,r,i){return md5_cmn(t&o|n&~o,e,t,s,r,i)}function md5_hh(e,t,n,o,s,r,i){return md5_cmn(t^n^o,e,t,s,r,i)}function md5_ii(e,t,n,o,s,r,i){return md5_cmn(n^(t|~o),e,t,s,r,i)}function safe_add(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function bit_rol(e,t){return e<<t|e>>>32-t}if(jws.tools={zerofill:function(e,t){var n=e.toFixed(0);if(n.length>t)n=n.substring(n.length-t);else for(;n.length<t;)n="0"+n;return n},calcMD5:function(e){return hex_md5(e)},escapeSQL:function(e){return e},date2ISO:function(e){var t=-e.getTimezoneOffset();Math.abs(t);return e.getUTCFullYear()+"-"+this.zerofill(e.getUTCMonth()+1,2)+"-"+this.zerofill(e.getUTCDate(),2)+"T"+this.zerofill(e.getUTCHours(),2)+":"+this.zerofill(e.getUTCMinutes(),2)+":"+this.zerofill(e.getUTCSeconds(),2)+"."+this.zerofill(e.getUTCMilliseconds(),3)+"Z"},ISO2Date:function(e,t){var n=new Date;return n.setUTCFullYear(e.substr(0,4)),n.setUTCMonth(e.substr(5,2)-1),n.setUTCDate(e.substr(8,2)),n.setUTCHours(e.substr(11,2)),n.setUTCMinutes(e.substr(14,2)),n.setUTCSeconds(e.substr(17,2)),n.setUTCMilliseconds(e.substr(20,3)),n},date2String:function(e){return e.getUTCFullYear()+this.zerofill(e.getUTCMonth()+1,2)+this.zerofill(e.getUTCDate(),2)+this.zerofill(e.getUTCHours(),2)+this.zerofill(e.getUTCMinutes(),2)+this.zerofill(e.getUTCSeconds(),2)+this.zerofill(e.getUTCMilliseconds(),2)},string2Date:function(e){var t=new Date;return t.setUTCFullYear(e.substr(0,4)),t.setUTCMonth(e.substr(4,2)-1),t.setUTCDate(e.substr(6,2)),t.setUTCHours(e.substr(8,2)),t.setUTCMinutes(e.substr(10,2)),t.setUTCSeconds(e.substr(12,2)),t.setUTCMilliseconds(e.substr(14,3)),t},generateSharedUTID:function(e){var t=JSON.stringify(e).split("");return t.sort(),hex_md5("{"+t.toString()+"}")},getType:function(e){var t=e,n=typeof t;return"number"==n?n=parseFloat(t)==parseInt(t)?"integer":"double":"[object Array]"===Object.prototype.toString.call(t)?n="array":null===t&&(n="null"),n}},!jws.browserSupportsNativeWebSockets){var swfobject=function(){var c,l,u,f,a,d,m="undefined",w="object",h="Shockwave Flash",p="application/x-shockwave-flash",g="SWFObjectExprInst",e="onreadystatechange",S=window,_=document,b=navigator,y=!1,o=[function(){y?function(){var t=_.getElementsByTagName("body")[0],n=x(w);n.setAttribute("type",p);var o=t.appendChild(n);if(o){var s=0;!function(){if(typeof o.GetVariable!=m){var e=o.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),T.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(s<10)return s++,setTimeout(arguments.callee,10);t.removeChild(n),o=null,j()}()}else j()}():j()}],C=[],v=[],i=[],s=!1,O=!1,r=!0,T=function(){var e=typeof _.getElementById!=m&&typeof _.getElementsByTagName!=m&&typeof _.createElement!=m,t=b.userAgent.toLowerCase(),n=b.platform.toLowerCase(),o=/win/.test(n||t),s=/mac/.test(n||t),r=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),i=!1,a=[0,0,0],c=null;if(typeof b.plugins!=m&&typeof b.plugins[h]==w)!(c=b.plugins[h].description)||typeof b.mimeTypes!=m&&b.mimeTypes[p]&&!b.mimeTypes[p].enabledPlugin||(i=!(y=!0),c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=parseInt(c.replace(/^(.*)\..*$/,"$1"),10),a[1]=parseInt(c.replace(/^.*\.(.*)\s.*$/,"$1"),10),a[2]=/[a-zA-Z]/.test(c)?parseInt(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof S.ActiveXObject!=m)try{var l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");l&&(c=l.GetVariable("$version"))&&(i=!0,c=c.split(" ")[1].split(","),a=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)])}catch(e){}return{w3:e,pv:a,wk:r,ie:i,win:o,mac:s}}();T.w3&&((typeof _.readyState!=m&&"complete"==_.readyState||typeof _.readyState==m&&(_.getElementsByTagName("body")[0]||_.body))&&t(),s||(typeof _.addEventListener!=m&&_.addEventListener("DOMContentLoaded",t,!1),T.ie&&T.win&&(_.attachEvent(e,function(){"complete"==_.readyState&&(_.detachEvent(e,arguments.callee),t())}),S==top&&function(){if(!s){try{_.documentElement.doScroll("left")}catch(e){return setTimeout(arguments.callee,0)}t()}}()),T.wk&&function(){s||(/loaded|complete/.test(_.readyState)?t():setTimeout(arguments.callee,0))}(),E(t)));function t(){if(!s){try{var e=_.getElementsByTagName("body")[0].appendChild(x("span"));e.parentNode.removeChild(e)}catch(e){return}s=!0;for(var t=o.length,n=0;n<t;n++)o[n]()}}function n(e){s?e():o[o.length]=e}function E(e){if(typeof S.addEventListener!=m)S.addEventListener("load",e,!1);else if(typeof _.addEventListener!=m)_.addEventListener("load",e,!1);else if(typeof S.attachEvent!=m)o="onload",s=e,(n=S).attachEvent(o,s),i[i.length]=[n,o,s];else if("function"==typeof S.onload){var t=S.onload;S.onload=function(){t(),e()}}else S.onload=e;var n,o,s}function j(){var e=C.length;if(0<e)for(var t=0;t<e;t++){var n=C[t].id,o=C[t].callbackFn,s={success:!1,id:n};if(0<T.pv[0]){var r=P(n);if(r)if(!U(C[t].swfVersion)||T.wk&&T.wk<312)if(C[t].expressInstall&&I()){var i={};i.data=C[t].expressInstall,i.width=r.getAttribute("width")||"0",i.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(i.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(i.align=r.getAttribute("align"));for(var a={},c=r.getElementsByTagName("param"),l=c.length,u=0;u<l;u++)"movie"!=c[u].getAttribute("name").toLowerCase()&&(a[c[u].getAttribute("name")]=c[u].getAttribute("value"));R(i,a,n,o)}else N(r),o&&o(s);else D(n,!0),o&&(s.success=!0,s.ref=k(n),o(s))}else if(D(n,!0),o){var f=k(n);f&&typeof f.SetVariable!=m&&(s.success=!0,s.ref=f),o(s)}}}function k(e){var t=null,n=P(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=m)t=n;else{var o=n.getElementsByTagName(w)[0];o&&(t=o)}return t}function I(){return!O&&U("6.0.65")&&(T.win||T.mac)&&!(T.wk&&T.wk<312)}function R(e,t,n,o){u=o||null,f={success:!(O=!0),id:n};var s=P(n);if(s){l="OBJECT"==s.nodeName?(c=W(s),null):(c=s,n),e.id=g,(typeof e.width==m||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==m||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),_.title=_.title.slice(0,47)+" - Flash Player Installation";var r=T.ie&&T.win?"ActiveX":"PlugIn",i="MMredirectURL="+S.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+_.title;if(typeof t.flashvars!=m?t.flashvars+="&"+i:t.flashvars=i,T.ie&&T.win&&4!=s.readyState){var a=x("div");n+="SWFObjectNew",a.setAttribute("id",n),s.parentNode.insertBefore(a,s),s.style.display="none",function(){4==s.readyState?s.parentNode.removeChild(s):setTimeout(arguments.callee,10)}()}A(e,t,n)}}function N(e){if(T.ie&&T.win&&4!=e.readyState){var t=x("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(W(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(W(e),e)}function W(e){var t=x("div");if(T.win&&T.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(w)[0];if(n){var o=n.childNodes;if(o)for(var s=o.length,r=0;r<s;r++)1==o[r].nodeType&&"PARAM"==o[r].nodeName||8==o[r].nodeType||t.appendChild(o[r].cloneNode(!0))}}return t}function A(e,t,n){var o,s=P(n);if(T.wk&&T.wk<312)return o;if(s)if(typeof e.id==m&&(e.id=n),T.ie&&T.win){var r="";for(var i in e)e[i]!=Object.prototype[i]&&("data"==i.toLowerCase()?t.movie=e[i]:"styleclass"==i.toLowerCase()?r+=' class="'+e[i]+'"':"classid"!=i.toLowerCase()&&(r+=" "+i+'="'+e[i]+'"'));var a="";for(var c in t)t[c]!=Object.prototype[c]&&(a+='<param name="'+c+'" value="'+t[c]+'" />');s.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+a+"</object>",v[v.length]=e.id,o=P(e.id)}else{var l=x(w);for(var u in l.setAttribute("type",p),e)e[u]!=Object.prototype[u]&&("styleclass"==u.toLowerCase()?l.setAttribute("class",e[u]):"classid"!=u.toLowerCase()&&l.setAttribute(u,e[u]));for(var f in t)t[f]!=Object.prototype[f]&&"movie"!=f.toLowerCase()&&L(l,f,t[f]);s.parentNode.replaceChild(l,s),o=l}return o}function L(e,t,n){var o=x("param");o.setAttribute("name",t),o.setAttribute("value",n),e.appendChild(o)}function B(e){var t=P(e);t&&"OBJECT"==t.nodeName&&(T.ie&&T.win?(t.style.display="none",function(){4==t.readyState?function(e){var t=P(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function P(e){var t=null;try{t=_.getElementById(e)}catch(e){}return t}function x(e){return _.createElement(e)}function U(e){var t=T.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function M(e,t,n,o){if(!T.ie||!T.mac){var s=_.getElementsByTagName("head")[0];if(s){var r=n&&"string"==typeof n?n:"screen";if(o&&(d=a=null),!a||d!=r){var i=x("style");i.setAttribute("type","text/css"),i.setAttribute("media",r),a=s.appendChild(i),T.ie&&T.win&&typeof _.styleSheets!=m&&0<_.styleSheets.length&&(a=_.styleSheets[_.styleSheets.length-1]),d=r}T.ie&&T.win?a&&typeof a.addRule==w&&a.addRule(e,t):a&&typeof _.createTextNode!=m&&a.appendChild(_.createTextNode(e+" {"+t+"}"))}}}function D(e,t){if(r){var n=t?"visible":"hidden";s&&P(e)?P(e).style.visibility=n:M("#"+e,"visibility:"+n)}}function F(e){return null!=/[\\\"<>\.;]/.exec(e)&&typeof encodeURIComponent!=m?encodeURIComponent(e):e}T.ie&&T.win&&window.attachEvent("onunload",function(){for(var e=i.length,t=0;t<e;t++)i[t][0].detachEvent(i[t][1],i[t][2]);for(var n=v.length,o=0;o<n;o++)B(v[o]);for(var s in T)T[s]=null;for(var r in T=null,swfobject)swfobject[r]=null;swfobject=null});return{registerObject:function(e,t,n,o){if(T.w3&&e&&t){var s={};s.id=e,s.swfVersion=t,s.expressInstall=n,s.callbackFn=o,C[C.length]=s,D(e,!1)}else o&&o({success:!1,id:e})},getObjectById:function(e){if(T.w3)return k(e)},embedSWF:function(i,a,c,l,u,f,d,h,p,g){var S={success:!1,id:a};T.w3&&!(T.wk&&T.wk<312)&&i&&a&&c&&l&&u?(D(a,!1),n(function(){c+="",l+="";var e={};if(p&&typeof p===w)for(var t in p)e[t]=p[t];e.data=i,e.width=c,e.height=l;var n={};if(h&&typeof h===w)for(var o in h)n[o]=h[o];if(d&&typeof d===w)for(var s in d)typeof n.flashvars!=m?n.flashvars+="&"+s+"="+d[s]:n.flashvars=s+"="+d[s];if(U(u)){var r=A(e,n,a);e.id==a&&D(a,!0),S.success=!0,S.ref=r}else{if(f&&I())return e.data=f,void R(e,n,a,g);D(a,!0)}g&&g(S)})):g&&g(S)},switchOffAutoHideShow:function(){r=!1},ua:T,getFlashPlayerVersion:function(){return{major:T.pv[0],minor:T.pv[1],release:T.pv[2]}},hasFlashPlayerVersion:U,createSWF:function(e,t,n){return T.w3?A(e,t,n):void 0},showExpressInstall:function(e,t,n,o){T.w3&&I()&&R(e,t,n,o)},removeSWF:function(e){T.w3&&B(e)},createCSS:function(e,t,n,o){T.w3&&M(e,t,n,o)},addDomLoadEvent:n,addLoadEvent:E,getQueryParamValue:function(e){var t=_.location.search||_.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return F(t);for(var n=t.split("&"),o=0;o<n.length;o++)if(n[o].substring(0,n[o].indexOf("="))==e)return F(n[o].substring(n[o].indexOf("=")+1))}return""},expressInstallCallback:function(){if(O){var e=P(g);e&&c&&(e.parentNode.replaceChild(c,e),l&&(D(l,!0),T.ie&&T.win&&(c.style.display="block")),u&&u(f)),O=!1}}}}();swfobject.hasFlashPlayerVersion("10.0.0")?(WEB_SOCKET_DEBUG=!0,function(){for(var e=document.getElementsByTagName("script"),t=0,n=e.length;t<n;t++){var o=e[t],s=o.src;if(s||(s=o.getAttribute("src")),s){var r=s.lastIndexOf("jWebSocket_Bundle_min.js");if(r<0&&(r=s.lastIndexOf("jWebSocket_Bundle.js")),r<0&&(r=s.lastIndexOf("jWebSocket.js")),0<r){window.WEB_SOCKET_SWF_LOCATION=s.substr(0,r)+"flash-bridge/WebSocketMain.swf",jws.JWS_FLASHBRIDGE=window.WEB_SOCKET_SWF_LOCATION;break}}}}(),window.WEB_SOCKET_SWF_LOCATION&&function(){if(!window.WebSocket){var n=window.console;n&&n.log&&n.error||(n={log:function(){},error:function(){}}),swfobject.hasFlashPlayerVersion("10.0.0")?("file:"==location.protocol&&n.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,o,s){var r=this;r.__id=WebSocket.__nextId++,(WebSocket.__instances[r.__id]=r).readyState=WebSocket.CONNECTING,r.bufferedAmount=0,r.__events={},setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(r.__id,e,t,n||null,o||0,s||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return t<0||(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t,n){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t,n){if(e in this.__events)for(var o=this.__events[e],s=o.length-1;0<=s;--s)if(o[s]===t){o.splice(s,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var o=this["on"+e.type];o&&o(e)},WebSocket.prototype.__handleEvent=function(e){var t;if("readyState"in e&&(this.readyState=e.readyState),"open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash)if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),window.WEB_SOCKET_SWF_LOCATION){var e=document.createElement("div");e.id="webSocketContainer",e.style.position="absolute",WebSocket.__isFlashLite()?(e.style.left="0px",e.style.top="0px"):(e.style.left="-100px",e.style.top="-100px");var t=document.createElement("div");t.id="webSocketFlash",e.appendChild(t),document.body.appendChild(e),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(e){e.success||n.error("[WebSocket] swfobject.embedSWF failed")})}else n.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf")},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var e=WebSocket.__flash.receiveEvents(),t=0;t<e.length;++t)WebSocket.__instances[e[t].webSocketId].__handleEvent(e[t])}catch(e){n.error(e)}},0),!0},WebSocket.__log=function(e){n.log(decodeURIComponent(e))},WebSocket.__error=function(e){n.error(decodeURIComponent(e))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return!!(e&&e.enabledPlugin&&e.enabledPlugin.filename)&&!!e.enabledPlugin.filename.match(/flashlite/i)},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))):n.error("Flash Player >= 10.0.0 is required.")}}()):WebSocket=null}jws.XHR={ASYNC:!0,SYNC:!1,METHOD_GET:"get",METHOD_POST:"post",METHOD_HEAD:"head",getXHRInstance:function(){var t=null;if(window.XMLHttpRequest)t=new XMLHttpRequest;else{if(!window.ActiveXObject)throw"f3.cfw.std.ex.xhr.NotAvail";try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw"f3.cfw.std.ex.xhr.NotAvail"}}}return t},isProtocolOk:function(e){return e||(e=self),!(e.location.protocol&&"file:"==e.location.protocol.toLowerCase())},mXHRSucClbk:function(e,t){throw"f3.cfw.std.ex.xhr.NoSuccObs"},mXHRErrClbk:function(e,t){throw"f3.cfw.std.ex.xhr.NoErrObs"},mXHRRespLsnr:function(){var e=arguments.callee.options;if(void 0!==f3.ajax.Request)switch(e.OnReadyStateChange&&e.OnReadyStateChange(e.XHR,e),e.XHR.readyState){case 0:case 1:case 2:case 3:break;case 4:clearTimeout(e.hTimeout),200==e.XHR.status?f3.dom.Event.callObserver(e.OnSuccess,e.XHR,e):f3.dom.Event.callObserver(e.OnError,e.XHR,e),e.XHR=null,e=null,arguments.callee.self=null,arguments.callee.options=null;break;default:e.OnError(e.XHR,e),e.XHR=null,e=null,arguments.callee.self=null,arguments.callee.options=null}},request:function(e,t){if(t=f3.core.OOP.getDefaultOptions(t,{method:"POST",asynchronous:f3.ajax.Common.ASYNC,postBody:null,timeout:-1,OnSuccess:f3.ajax.Request.mXHRSucClbk,OnError:f3.ajax.Request.mXHRErrClbk,contentType:"text/plain; charset=UTF-8",cacheControl:"must-revalidate"}),!f3.ajax.Common.isProtocolOk())throw new Error(0,f3.localeManager.getCurLocStr("f3.cfw.std.ex.xhr.file"));if(t.XHR=f3.ajax.Common.getXHRInstance(),t.XHR){t.XHR.open(t.method,e,t.asynchronous),"post"==t.method.toLowerCase()&&t.XHR.setRequestHeader("Content-type",t.contentType),t.cacheControl&&t.XHR.setRequestHeader("Cache-Control",t.cacheControl);var n=new $f3.$XHRResponse(t);!f3.browser.Browser.isFirefox()||t.asynchronous?t.XHR.onreadystatechange=n.mXHRRespLsnr:t.XHR.onreadystatechange=null,0<t.timeout&&(t.hTimeout=setTimeout(function(){t.XHR.abort(),f3.browser.Browser.isFirefox()&&!t.asynchronous&&n.handler(t)},t.timeout));try{t.XHR.send(t.postBody)}catch(e){t.OnError(t.XHR,t)}f3.browser.Browser.isFirefox()&&!t.asynchronous&&n.mXHRRespLsnr(t)}return t.XHR}},jws.browserSupportsNativeJSON||(this.JSON||(this.JSON={}),function(){function f(e){return e<10?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,o,s,r,i,a=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(c)){for(r=c.length,n=0;n<r;n+=1)i[n]=str(n,c)||"null";return s=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+a+"]":"["+i.join(",")+"]",gap=a,s}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;n<r;n+=1)"string"==typeof(o=rep[n])&&(s=str(o,c))&&i.push(quote(o)+(gap?": ":":")+s);else for(o in c)Object.hasOwnProperty.call(c,o)&&(s=str(o,c))&&i.push(quote(o)+(gap?": ":":")+s);return s=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+a+"}":"{"+i.join(",")+"}",gap=a,s}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var o;if(indent=gap="","number"==typeof n)for(o=0;o<n;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if((rep=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,o,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.hasOwnProperty.call(s,n)&&(void 0!==(o=walk(s,n))?s[n]=o:delete s[n]);return reviver.call(e,t,s)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}());var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,o,s,r,i,a,c="",l=0;for(e=Base64._utf8_encode(e);l<e.length;)s=(t=e.charCodeAt(l++))>>2,r=(3&t)<<4|(n=e.charCodeAt(l++))>>4,i=(15&n)<<2|(o=e.charCodeAt(l++))>>6,a=63&o,isNaN(n)?i=a=64:isNaN(o)&&(a=64),c=c+this._keyStr.charAt(s)+this._keyStr.charAt(r)+this._keyStr.charAt(i)+this._keyStr.charAt(a);return c},decode:function(e){var t,n,o,s,r,i,a="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(s=this._keyStr.indexOf(e.charAt(c++)))>>4,n=(15&s)<<4|(r=this._keyStr.indexOf(e.charAt(c++)))>>2,o=(3&r)<<6|(i=this._keyStr.indexOf(e.charAt(c++))),a+=String.fromCharCode(t),64!=r&&(a+=String.fromCharCode(n)),64!=i&&(a+=String.fromCharCode(o));return a=Base64._utf8_decode(a)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):(127<o&&o<2048?t+=String.fromCharCode(o>>6|192):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128)),t+=String.fromCharCode(63&o|128))}return t},_utf8_decode:function(e){for(var t="",n=0,o=c1=c2=0;n<e.length;)(o=e.charCodeAt(n))<128?(t+=String.fromCharCode(o),n++):191<o&&o<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&c2)<<6|63&c3),n+=3);return t}};jws.oop={},jws.oop.declareClass=function(e,t,n,o){var s=self[e];s||(self[e]={});var r,i=function(){this.create&&this.create.apply(this,arguments)};for(r in s[t]=i,o)i.prototype[r]=o[r];if(null!=n)for(r in n.descendants||(n.descendants=[]),n.descendants.push(i),n.prototype){var a=n.prototype[r];"function"==typeof a&&(i.prototype[r]?i.prototype[r].inherited=a:i.prototype[r]=a,i.prototype[r].superClass=n)}},jws.oop.addPlugIn=function(e,t){for(var n in e.fPlugIns||(e.fPlugIns=[]),e.fPlugIns.push(t),t)e.prototype[n]||(e.prototype[n]=t[n]);if(e.descendants)for(var o=0,s=e.descendants.length;o<s;o++)jws.oop.addPlugIn(e.descendants[o],t)},jws.oop.declareClass("jws","jWebSocketBaseClient",null,{create:function(e){this.fReliabilityOptions||(this.fReliabilityOptions=jws.RO_OFF)},processOpened:function(e){},processPacket:function(e){},processClosed:function(e){},open:function(e,t){if(t||(t={}),!self.WebSocket)throw new Error("WebSockets not supported by browser");if(this.fConn)throw new Error("Already connected");var n=this,o=null,s=jws.WS_SUBPROT_JSON;t.subProtocol&&(s=t.subProtocol),t.reliabilityOptions&&(this.fReliabilityOptions=t.reliabilityOptions),this.fReliabilityOptions&&(this.fReliabilityOptions.isExplicitClose=!1),this.fStatus!=jws.RECONNECTING&&(this.fStatus=jws.CONNECTING),t.OnOpenTimeout&&"function"==typeof t.OnOpenTimeout&&t.openTimeout&&(this.fOpenTimeout=t.openTimeout,this.hOpenTimeout=setTimeout(function(){n.fOpenTimeout=null;t.OnOpenTimeout({})},this.fOpenTimeout)),this.fConn=new WebSocket(e,s),this.fURL=e,this.fSubProt=s,this.fConn.onopen=function(e){n.hOpenTimeout&&(clearTimeout(n.hOpenTimeout),n.hOpenTimeout=null),n.fStatus=jws.OPEN,o=n.processOpened(e),t.OnOpen&&t.OnOpen(e,o,n),n.processQueue()},this.fConn.onmessage=function(e){o=n.processPacket(e),t.OnMessage&&t.OnMessage(e,o,n)},this.fConn.onclose=function(e){n.hOpenTimeout&&(clearTimeout(n.hOpenTimeout),n.hOpenTimeout=null),n.fStatus=jws.CLOSED,n.hDisconnectTimeout&&(clearTimeout(n.hDisconnectTimeout),delete n.hDisconnectTimeout),o=n.processClosed(e),t.OnClose&&t.OnClose(e,o,n),n.fConn=null,n.fReliabilityOptions&&n.fReliabilityOptions.autoReconnect&&!n.fReliabilityOptions.isExplicitClose&&(n.fStatus=jws.RECONNECTING,n.hReconnectDelayTimeout=setTimeout(function(){t.OnReconnecting&&t.OnReconnecting(e,o,n),n.open(n.fURL,t)},n.fReliabilityOptions.reconnectDelay))}},connect:function(e,t){return this.open(e,t)},processQueue:function(){if(this.fOutQueue&&0==this.checkConnected().code)for(var e;0<this.fOutQueue.length;)e=this.fOutQueue.shift(),this.fConn.send(e.packet)},queuePacket:function(e,t){this.fOutQueue||(this.fOutQueue=[]),this.fOutQueue.push({packet:e,options:t})},sendStream:function(e){if(this.isOpened())try{this.fConn.send(e)}catch(e){}else{if(!this.isWriteable())throw new Error("Not connected");this.queuePacket(e,null)}},abortReconnect:function(){return!!this.hReconnectDelayTimeout&&(clearTimeout(this.hReconnectDelayTimeout),!(this.hReconnectDelayTimeout=null))},setAutoReconnect:function(e){e&&"boolean"==typeof aLimit?this.fReliabilityOptions.autoReconnect=e:this.fReliabilityOptions.autoReconnect=!1,this.fReliabilityOptions&&this.fReliabilityOptions.autoReconnect||abortReconnect()},setQueueItemLimit:function(e){this.fReliabilityOptions.queueItemLimit=e&&"number"==typeof e&&0<e?parseInt(e):0},setQueueSizeLimit:function(e){this.fReliabilityOptions.queueSizeLimit=e&&"number"==typeof e&&0<e?parseInt(e):0},setReliabilityOptions:function(e){this.fReliabilityOptions=e,this.fReliabilityOptions&&(this.fReliabilityOptions.autoReconnect||abortReconnect())},getReliabilityOptions:function(){return this.fReliabilityOptions},getOutQueue:function(){return this.fOutQueue},resetSendQueue:function(){delete this.fOutQueue},isOpened:function(){return null!=this.fConn&&null!=this.fConn&&this.fConn.readyState==jws.OPEN},getURL:function(){return this.fURL},getSubProt:function(){return this.fSubProt},isConnected:function(){return this.isOpened()},forceClose:function(e){if(this.fReliabilityOptions&&(this.fReliabilityOptions.isExplicitClose=!0),e&&e.fireClose&&this.fConn.onclose){this.fConn.onclose({})}this.fConn&&(this.fConn.onopen=null,this.fConn.onmessage=null,this.fConn.onclose=null,this.fConn.readyState==jws.OPEN&&this.fConn.close(),this.processClosed()),this.fConn=null},close:function(e){var t=0;if(e&&e.timeout&&(t=e.timeout),!this.fConn)throw this.fConn=null,new Error("Not connected");if(t<=0)this.forceClose(e);else{var n=this;this.hDisconnectTimeout=setTimeout(function(){n.forceClose(e)},t)}},disconnect:function(e){return this.close(e)},addListener:function(e){this.fListeners||(this.fListeners=[]),this.fListeners.push(e)},removeListener:function(e){if(this.fListeners)for(var t=0,n=this.fListeners;t<n;t++)e==this.fListeners[t]&&this.fListeners.splice(t,1)},addPlugIn:function(e,t){this.fPlugIns||(this.fPlugIns=[]),this.fPlugIns.push(e),t||(t=e.ID),t&&(e.conn=this)},setParam:function(e,t){this.fParams||(this.fParams={});var n=this.getParam(e);return this.fParams[e]=t,n},getParam:function(e){if(!this.fParams)return null;var t=this.fParams[e];return void 0===t?null:t},setParamNS:function(e,t,n){return this.setParam(e+"."+t,n)},getParamNS:function(e,t){return this.getParam(e+"."+t)},clearParams:function(){this.fParams&&delete this.fParams}}),jws.oop.declareClass("jws","jWebSocketTokenClient",jws.jWebSocketBaseClient,{create:function(e){arguments.callee.inherited.call(this,e),this.fRequestCallbacks={}},getId:function(){return this.fClientId},checkCallbacks:function(e){var t="utid"+e.utid,n=this.fRequestCallbacks[t];if(n){n.hCleanUp&&clearTimeout(n.hCleanUp);var o=n.args,s=n.callback;s.OnResponse&&s.OnResponse.call(this,e,o),s.OnSuccess&&0===e.code&&s.OnSuccess.call(this,e,o),s.OnFailure&&null!=e.code&&0!=e.code&&s.OnFailure.call(this,e,o),delete this.fRequestCallbacks[t]}},createDefaultResult:function(){return{code:0,msg:"Ok",localeKey:"jws.jsc.res.Ok",args:null,tid:jws.CUR_TOKEN_ID}},checkConnected:function(){var e=this.createDefaultResult();return this.isOpened()||(e.code=-1,e.localeKey="jws.jsc.res.notConnected",e.msg="Not connected."),e},isWriteable:function(){return this.isOpened()||this.fStatus==jws.RECONNECTING},checkWriteable:function(){var e=this.createDefaultResult();return this.isWriteable()||(e.code=-1,e.localeKey="jws.jsc.res.notWriteable",e.msg="Not writable."),e},checkLoggedIn:function(){var e=this.checkConnected();return 0!=e.code||this.isLoggedIn()||(e.code=-1,e.localeKey="jws.jsc.res.notLoggedIn",e.msg="Not logged in."),e},resultToString:function(e){return e&&"object"==typeof e&&e.msg?e.msg:"invalid response token"},tokenToStream:function(e){throw new Error("tokenToStream needs to be overwritten in descendant classes")},streamToToken:function(e){throw new Error("streamToToken needs to be overwritten in descendant classes")},notifyPlugInsOpened:function(){var e={sourceId:this.fClientId},t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;n<o;n++){var s=t[n];s.processOpened&&s.processOpened.call(this,e)}},notifyPlugInsClosed:function(){var e={sourceId:this.fClientId},t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;n<o;n++){var s=t[n];s.processClosed&&s.processClosed.call(this,e)}this.fConn=null,this.fSessionId=null,this.fUsername=null},processPacket:function(e){var t=this.streamToToken(e.data);return this.processToken(t),t},processToken:function(e){var t,n,o,s,r=e.ns;if(null!=r&&1==r.indexOf("org.jWebSocket")?e.ns="org.jwebsocket"+r.substring(15):null==r&&(e.ns="org.jwebsocket.plugins.system"),jws.NS_SYSTEM==e.ns)if("welcome"==e.type&&e.usid){this.fSessionId=e.usid,this.fClientId=e.sourceId,this.notifyPlugInsOpened(),this.fOnWelcome&&this.fOnWelcome(e);var i="n/a";if(swfobject){var a=swfobject.getFlashPlayerVersion();i=a.major+"."+a.minor+"."+a.release}this.sendToken({ns:jws.SystemClientPlugIn.NS,type:"header",clientType:"browser",clientName:jws.getBrowserName(),clientVersion:jws.getBrowserVersionString(),clientInfo:navigator.userAgent,jwsType:"javascript",jwsVersion:jws.VERSION,jwsInfo:jws.browserSupportsNativeWebSockets?"native":"flash "+i},{})}else"goodBye"==e.type?(this.fOnGoodBye&&this.fOnGoodBye(e),this.fSessionId=null,this.fUsername=null):"close"==e.type?this.close({timeout:0}):"response"==e.type?("login"==e.reqType&&(this.fUsername=e.username,e.usid&&(this.fSessionId=e.usid)),"logout"==e.reqType&&(this.fUsername=null),this.checkCallbacks(e)):"event"==e.type&&("connect"==e.name&&this.processConnected(e),"disconnect"==e.name&&this.processDisconnected(e));else this.checkCallbacks(e);if(o=jws.jWebSocketTokenClient.fPlugIns)for(t=0,n=o.length;t<n;t++)(s=o[t]).processToken&&s.processToken.call(this,e);if(o=this.fPlugIns)for(t=0,n=o.length;t<n;t++)(s=o[t]).processToken&&s.processToken(e);if(this.fOnToken&&this.fOnToken(e),this.fListeners)for(t=0,n=this.fListeners.length;t<n;t++)this.fListeners[t](e)},processClosed:function(e){this.notifyPlugInsClosed(),this.fClientId=null},processConnected:function(e){var t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;n<o;n++){var s=t[n];s.processConnected&&s.processConnected.call(this,e)}},processDisconnected:function(e){var t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;n<o;n++){var s=t[n];s.processDisconnected&&s.processDisconnected.call(this,e)}},sendToken:function(t,e){var n=this.checkWriteable();if(0==n.code){var o=!1,s=0,r=jws.DEF_RESP_TIMEOUT,i=!1,a=null,c={OnResponse:null,OnSuccess:null,OnFailure:null,OnTimeout:null},l=!1;if(e&&(e.OnResponse&&(c.OnResponse=e.OnResponse,l=!0),e.OnFailure&&(c.OnFailure=e.OnFailure,l=!0),e.OnSuccess&&(c.OnSuccess=e.OnSuccess,l=!0),e.OnTimeout&&(c.OnTimeout=e.OnTimeout,l=!0),e.args&&(a=e.args),e.timeout&&(r=e.timeout),e.spawnThread&&(o=e.spawnThread),e.fragmentSize&&(s=e.fragmentSize),e.keepRequest&&(i=!0)),jws.CUR_TOKEN_ID++,l){var u=jws.CUR_TOKEN_ID,f="utid"+u,d=this,h={request:(new Date).getTime(),callback:c,args:a,timeout:r};i&&(h.request=t),(this.fRequestCallbacks[f]=h).hCleanUp=setTimeout(function(){var e=h.callback;delete d.fRequestCallbacks[f],e.OnTimeout&&e.OnTimeout.call(this,t,{utid:u,timeout:r})},r)}o&&(t.spawnThread=!0);var p=this.tokenToStream(t);if(0<s&&0<p.length)for(var g,S,m=0,w=p.length;0<p.length;)g={ns:jws.NS_SYSTEM,type:"fragment",utid:t.utid,index:m++,total:parseInt(w/s)+1,data:p.substr(0,s)},s,p=p.substr(s),S=this.tokenToStream(g),this.sendStream(S);else this.sendStream(p)}return n},getLastTokenId:function(){return jws.CUR_TOKEN_ID},getNextTokenId:function(){return jws.CUR_TOKEN_ID+1},sendText:function(e,t){var n=this.checkLoggedIn();return 0==n.code&&this.sendToken({ns:jws.NS_SYSTEM,type:"send",targetId:e,sourceId:this.fClientId,sender:this.fUsername,data:t}),n},broadcastText:function(e,t,n){var o=this.checkLoggedIn(),s=!1,r=!0;return n&&(n.senderIncluded&&(s=n.senderIncluded),n.responseRequested&&(r=n.responseRequested)),0==o.code&&this.sendToken({ns:jws.NS_SYSTEM,type:"broadcast",sourceId:this.fClientId,sender:this.fUsername,pool:e,data:t,senderIncluded:s,responseRequested:r},n),o},echo:function(e){var t=this.checkWriteable();return 0==t.code&&this.sendToken({ns:jws.NS_SYSTEM,type:"echo",data:e}),t},open:function(e,t){var n=this.createDefaultResult();try{t&&t.OnToken&&"function"==typeof t.OnToken&&(this.fOnToken=t.OnToken),t&&t.OnWelcome&&"function"==typeof t.OnWelcome&&(this.fOnWelcome=t.OnWelcome),t&&t.OnGoodBye&&"function"==typeof t.OnGoodBye&&(this.fOnGoodBye=t.OnGoodBye),arguments.callee.inherited.call(this,e,t)}catch(e){n.code=-1,n.localeKey="jws.jsc.ex",n.args=[e.message],n.msg="Exception on open: "+e.message}return n},connect:function(e,t){return this.open(e,t)},close:function(e){var t=0,n=!1,o=!1,s=!1;this.fReliabilityOptions&&(this.fReliabilityOptions.isExplicitClose=!0),e&&(e.timeout&&(t=e.timeout),e.noGoodBye&&(n=!0),e.noLogoutBroadcast&&(o=!0),e.noDisconnectBroadcast&&(s=!0));var r=this.checkConnected();try{if(0==r.code){var i={ns:jws.NS_SYSTEM,type:"close",timeout:t};n&&(i.noGoodBye=!0),o&&(i.noLogoutBroadcast=!0),s&&(i.noDisconnectBroadcast=!0),this.sendToken(i),arguments.callee.inherited.call(this,e)}else r.code=-1,r.localeKey="jws.jsc.res.notConnected",r.msg="Not connected."}catch(e){r.code=-1,r.localeKey="jws.jsc.ex",r.args=[e.message],r.msg="Exception on close: "+e.message}return r},disconnect:function(e){return this.close(e)}}),jws.SystemClientPlugIn={NS:jws.NS_SYSTEM,ALL_CLIENTS:0,AUTHENTICATED:1,NON_AUTHENTICATED:2,PW_PLAIN:null,PW_ENCODE_MD5:1,PW_MD5_ENCODED:2,processToken:function(e){jws.NS_SYSTEM==e.ns&&("login"==e.reqType?0==e.code?this.fOnLoggedIn&&this.fOnLoggedIn(e):this.fOnLoginError&&this.fOnLoginError(e):"logout"==e.reqType&&(0==e.code?this.fOnLoggedOut&&this.fOnLoggedOut(e):this.fOnLogoutError&&this.fOnLogoutError(e)))},login:function(e,t,n){var o=null,s=null;n&&(void 0!==n.pool&&(o=n.pool),void 0!==n.encoding&&(s=n.encoding,s=jws.SystemClientPlugIn.PW_ENCODE_MD5==s?(t&&(t=jws.tools.calcMD5(t)),"md5"):jws.SystemClientPlugIn.PW_MD5_ENCODED==s?"md5":null));var r=this.createDefaultResult();return this.isOpened()?this.sendToken({ns:jws.SystemClientPlugIn.NS,type:"login",username:e,password:t,encoding:s,pool:o}):(r.code=-1,r.localeKey="jws.jsc.res.notConnected",r.msg="Not connected."),r},logon:function(e,t,n,o){var s=this.createDefaultResult();if(o||(o={}),this.isOpened())this.login(t,n,o);else{var r=o.OnWelcome,i=this;o.OnWelcome=function(e){r&&r.call(i,e),i.login(t,n,o)},this.open(e,o)}return s},logout:function(){var e=this.checkConnected();return 0==e.code&&this.sendToken({ns:jws.SystemClientPlugIn.NS,type:"logout"}),e},isLoggedIn:function(){return this.isOpened()&&this.fUsername},broadcastToken:function(e,t){return e.ns=jws.SystemClientPlugIn.NS,e.type="broadcast",e.sourceId=this.fClientId,e.sender=this.fUsername,this.sendToken(e,t)},getUsername:function(){return this.isLoggedIn()?this.fUsername:null},getClients:function(e){var t=jws.SystemClientPlugIn.ALL_CLIENTS,n=null;e&&(e.mode!=jws.SystemClientPlugIn.AUTHENTICATED&&e.mode!=jws.SystemClientPlugIn.NON_AUTHENTICATED||(t=e.mode),e.pool&&(n=e.pool));var o=this.createDefaultResult();return this.isLoggedIn()?this.sendToken({ns:jws.SystemClientPlugIn.NS,type:"getClients",mode:t,pool:n}):(o.code=-1,o.localeKey="jws.jsc.res.notLoggedIn",o.msg="Not logged in."),o},getNonAuthClients:function(e){return e||(e={}),e.mode=jws.SystemClientPlugIn.NON_AUTHENTICATED,this.getClients(e)},getAuthClients:function(e){return e||(e={}),e.mode=jws.SystemClientPlugIn.AUTHENTICATED,this.getClients(e)},getAllClients:function(e){return e||(e={}),e.mode=jws.SystemClientPlugIn.ALL_CLIENTS,this.getClients(e)},ping:function(e){var t=!1;e&&e.echo&&(t=!0);var n=this.createDefaultResult();return this.isOpened()?this.sendToken({ns:jws.SystemClientPlugIn.NS,type:"ping",echo:t},e):(n.code=-1,n.localeKey="jws.jsc.res.notConnected",n.msg="Not connected."),n},wait:function(e,t){var n=this.checkConnected();if(0==n.code){var o=!0;t&&null!=t.responseRequested&&(o=t.responseRequested),this.sendToken({ns:jws.SystemClientPlugIn.NS,type:"wait",duration:e,responseRequested:o},t)}return n},startKeepAlive:function(e){if(this.hKeepAlive&&stopKeepAlive(),this.isOpened()){var t=1e4,n=!0,o=!0;e&&(null!=e.interval&&(t=e.interval),null!=e.echo&&(n=e.echo),null!=e.immediate&&(o=e.immediate)),o&&this.ping({echo:n});var s=this;this.hKeepAlive=setInterval(function(){s.isOpened()?s.ping({echo:n}):s.stopKeepAlive()},t)}},stopKeepAlive:function(){this.hKeepAlive&&(clearInterval(this.hKeepAlive),this.hKeepAlive=null)},setSystemCallbacks:function(e){e||(e={}),void 0!==e.OnLoggedIn&&(this.fOnLoggedIn=e.OnLoggedIn),void 0!==e.OnLoginError&&(this.fOnLoginError=e.OnLoginError),void 0!==e.OnLoggedOut&&(this.fOnLoggedOut=e.OnLoggedOut),void 0!==e.OnLogoutError&&(this.fOnLogoutError=e.OnLogoutError)}},jws.oop.addPlugIn(jws.jWebSocketTokenClient,jws.SystemClientPlugIn),jws.oop.declareClass("jws","jWebSocketJSONClient",jws.jWebSocketTokenClient,{tokenToStream:function(e){return e.utid=jws.CUR_TOKEN_ID,JSON.stringify(e)},streamToToken:function(e){return JSON.parse(e)}}),jws.oop.declareClass("jws","jWebSocketCSVClient",jws.jWebSocketTokenClient,{tokenToStream:function(e){var t="utid="+jws.CUR_TOKEN_ID;for(var n in e){var o=e[n];t+=null==o?","+n+"=":"string"==typeof o?","+n+'="'+(o=(o=o.replace(/[,]/g,"\\x2C")).replace(/["]/g,"\\x22"))+'"':","+n+"="+o}return t},streamToToken:function(e){for(var t={},n=e.split(","),o=0,s=n.length;o<s;o++){var r=n[o].split("=");if(2==r.length){var i=r[0],a=r[1];2<=a.length&&'"'==a.charAt(0)&&'"'==a.charAt(a.length-1)&&(a=(a=(a=a.replace(/\\x2C/g,",")).replace(/\\x22/g,'"')).substr(1,a.length-2)),t[i]=a}}return t}}),jws.oop.declareClass("jws","jWebSocketXMLClient",jws.jWebSocketTokenClient,{tokenToStream:function(e){function i(e,t){var n="";if(t instanceof Array){n+="<"+e+' type="array">';for(var o=0,s=t.length;o<s;o++)n+=i("item",t[o]);n+="</"+e+">"}else if("object"==typeof t){for(var r in n+="<"+e+' type="object">',t)n+=i(r,t[r]);n+="</"+e+">"}else n+="<"+e+' type="'+typeof t+'">'+t.toString()+"</"+e+">";return n}var t='<?xml version="1.0" encoding="windows-1252"?><token>';for(var n in e)t+=i(n,e[n]);return t+="</token>"},streamToToken:function(e){var t=null;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){}var n={};return t&&function e(t,n){for(var o=t.firstChild;null!=o;){if(1==o.nodeType){var s=o.getAttribute("type"),r=o.nodeName;if(s){var i=o.firstChild;i&&3==i.nodeType?(i=i.nodeValue)&&("string"==s||"number"==s||"boolean"==s||"date"==s||(i=void 0),i&&(n instanceof Array?n.push(i):n[r]=i)):i&&1==i.nodeType&&("array"==s?(n[r]=[],e(o,n[r])):"object"==s&&(n[r]={},e(o,n[r])))}}o=o.nextSibling}}(t.firstChild,n),n}});var caChat={jWebSocketClient:new jws.jWebSocketJSONClient,did:"",apiKey:"",sessionId:null,email:!1,phoneNumber:!1,name:!1,fetchedSkills:!1,custDetails:{},checkSession:function(e){if(!this.apiKey||!this.did)return console.log("please provie apiKey and did"),"please provie apiKey and did";connectws(checkCustomer,e)},custChat:function(e){var t={ns:"ozonetel.cloudagent",type:"custchat",text:e.trim(),customer:"chat",agentId:"chat",sessionId:this.sessionId,clientId:this.sessionId,apiKey:this.apiKey,did:this.did};this.jWebSocketClient.sendToken(t,{OnResponse:function(e){console.log("Server responded: resp: "+e.resp)}})},custEndChat:function(){var e={ns:"ozonetel.cloudagent",type:"custEndChat",customer:"chat",agentId:"chat",sessionId:this.sessionId,clientId:this.sessionId,apiKey:this.apiKey,did:this.did,custDetails:JSON.stringify(this.custDetails)};console.log("sending end chat token"),console.log(e),this.jWebSocketClient.sendToken(e,{OnResponse:function(e){console.log("Server responded: resp: "+e.resp+"|"+e.msg)}}),this.jWebSocketClient.close()},imageUpload:function(e,s){console.log(e);var t=new FormData;t.append("fileName",e),t.append("apiKey",this.apiKey);var r,n=new XMLHttpRequest;n.open("POST","https://chatupload.cloudagent.in/ImageUpload/upload.php",!0),n.send(t),n.onload=function(e){var t=JSON.parse(this.responseText);if(console.log(t),200==this.status&&"success"==t.status){var n=t.message;console.log(n);var o={ns:"ozonetel.cloudagent",type:"custImgMsg",imageUrl:n,customer:"chat",agentId:"chat",sessionId:caChat.sessionId,clientId:caChat.sessionId,apiKey:caChat.apiKey,did:caChat.did};caChat.jWebSocketClient.sendToken(o,{OnResponse:function(e){console.log("Server responded: resp: "+e.resp)}})}else console.log("Upload failed");r=t.status,console.log("returning : "+r),s(r)}},fileUpload:function(e,s){console.log(e);var t=new FormData;t.append("fileName",e),t.append("apiKey",this.apiKey);var r,n=new XMLHttpRequest;n.open("POST","https://chatupload.cloudagent.in/ImageUpload/upload.php",!0),n.send(t),n.onload=function(e){var t=JSON.parse(this.responseText);if(console.log(t),200==this.status&&"success"==t.status){var n=t.message;console.log(n);var o={ns:"ozonetel.cloudagent",type:"custchat",text:n,customer:"chat",agentId:"chat",sessionId:caChat.sessionId,clientId:caChat.sessionId,apiKey:caChat.apiKey,did:caChat.did};console.log(o),caChat.jWebSocketClient.sendToken(o,{OnResponse:function(e){console.log("Server responded: resp: "+e.resp)}})}else console.log("Upload failed");r=t.status,console.log("returning : "+r),s(r)}},storeFeedback:function(e){var t={ns:"ozonetel.cloudagent",type:"storeCustomerFeedback",customer:"chat",agentId:"chat",sessionId:this.sessionId,clientId:this.sessionId,apiKey:this.apiKey,did:this.did,feedback:JSON.stringify(e)};console.log("sending feedback token"),console.log(t),this.jWebSocketClient.sendToken(t,{OnResponse:function(e){console.log("Server responded: resp: "+e.resp+"|"+e.msg)}})}};function connectws(e,n){var t="wss://msg7.cloudagent.in:9797";console.log("Connecting to "+t+" and logging in as ''...");caChat.jWebSocketClient.logon(t,"chat","chat",{OnOpen:function(e){console.log("jWebSocket connection established",e)},OnMessage:function(e,t){handleJWSMessage(e,t,n)},OnClose:function(e){localStorage.clear(),console.log("jWebSocket connection closed")}})}function checkCustomer(t){console.log("check sess called..");var e={ns:"ozonetel.cloudagent",type:"checkCustSess",customer:"chat",agentId:"chat",apiKey:caChat.apiKey,did:caChat.did,sessionId:caChat.sessionId,clientId:caChat.sessionId,custDetails:JSON.stringify(caChat.custDetails)};console.log("checking session with ms"),console.log(e),caChat.jWebSocketClient.sendToken(e,{OnResponse:function(e){console.log("Server responded: resp: "+e.resp+"|"+e.msg),t.checkCustomer&&t.checkCustomer(e),"old"==e.resp?console.log("old session"):"fetchingAgent"==e.resp?console.log("We're fetching agent buddy"):console.log(e)}})}function handleJWSMessage(e,t,n){if("welcome"==t.type)null!=t.sourceId&&(console.log("source id",t.sourceId),caChat.sessionId=t.sourceId,n.welcome&&n.welcome(t.sourceId)),checkCustomer(n);else if("chatMsg"==t.type)console.log("Received message from agent : "+t.agent+" | "+t.msg+" | "+t.ts),n.chatMsg&&n.chatMsg(t.agent,t.msg,t.ts);else if("brCast"==t.type){var o=t.msg;addMyMessage(o,new Date)}else"endChat"==t.type?(n.endChat&&n.endChat(t.agentClosed),caChat.jWebSocketClient.close()):"chaton"==t.type?(console.log("chat on called with agent.."+t.agent),n.chaton&&n.chaton(t.agent)):"imageMsg"==t.type?addImgMessage(t.agent,t.imageSrc,t.ts):"noagent"==t.type?(n.noagent&&n.noagent(),caChat.jWebSocketClient.close()):"getanagent"==t.type?n.getanagent&&n.getanagent():"fallback"==t.type?n.fallback&&n.fallback(t.msg):"collectUserInfo"==t.type?console.log("collect user info"+t.name+" : "+t.email+" : "+t.phone):"agentStartedTyping"==t.type?n.startTypingIndicator&&n.startTypingIndicator():"agentNoLongerTyping"==t.type&&n.stopTypingIndicator&&n.stopTypingIndicator()}function getAnAgent(){console.log("get and agent")}
